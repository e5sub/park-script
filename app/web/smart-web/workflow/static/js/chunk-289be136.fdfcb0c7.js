(window["webpackJsonp_workflow"]=window["webpackJsonp_workflow"]||[]).push([["chunk-289be136"],{"0b11":function(e,t,n){"use strict";n("dac7")},"114a":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"tabel-container"},[t("el-row",{staticStyle:{display:"flex"}},[t("el-col",{staticClass:"box-left"},[t("div",{staticClass:"box-top"},[t("el-input",{staticStyle:{"margin-bottom":"20px"},attrs:{placeholder:"请输入分类名称",clearable:"",size:"small","prefix-icon":"el-icon-search"},model:{value:e.categoryName,callback:function(t){e.categoryName=t},expression:"categoryName"}})],1),t("div",{staticClass:"scroll-box"},[t("div",{staticClass:"treeList"},[t("div",{staticStyle:{padding:"0 10px"}},[t("el-tree",{ref:"tree",staticStyle:{display:"inline-block","min-width":"180px"},attrs:{"node-key":"id",data:e.categoryList,props:e.defaultProps,"expand-on-click-node":!1,"filter-node-method":e.filterNode,"default-expand-all":"","highlight-current":"","current-node-key":e.nodeKey},on:{"node-click":e.handleCategoryClick}})],1)])])]),t("el-col",{staticClass:"box-right"},[t("div",{staticClass:"container"},[t("div",{staticClass:"treeList"},[t("el-card",{staticClass:"mb10",attrs:{shadow:"never"}},[t("el-row",[t("el-col",{attrs:{span:20}},[t("el-form",{ref:"queryForm",attrs:{model:e.form,"label-width":"120px","label-suffix":":"}},[t("el-form-item",{attrs:{label:"流程编码",prop:"procCode"}},[e._v(" "+e._s(e.form.procCode)+" ")]),t("el-form-item",{attrs:{label:"流程名称",prop:"procName"}},[e._v(" "+e._s(e.form.procName)+" ")]),t("el-form-item",{attrs:{label:"流程定义",prop:"procDefName"}},[t("el-input",{attrs:{placeholder:"请选择",clearable:"",size:"small"},on:{focus:e.handleSelect},model:{value:e.form.procDefName,callback:function(t){e.$set(e.form,"procDefName",t)},expression:"form.procDefName"}})],1),t("el-form-item",{attrs:{label:"审批URL",prop:"approveUrl"}},[t("el-input",{attrs:{placeholder:"请输入",clearable:"",size:"small"},model:{value:e.form.approveUrl,callback:function(t){e.$set(e.form,"approveUrl",t)},expression:"form.approveUrl"}})],1),t("el-form-item",{attrs:{label:"状态",prop:"status"}},[t("el-switch",{attrs:{"active-value":0,"inactive-value":1},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})],1),t("el-form-item",{attrs:{label:"填表说明",prop:"remark"}},[t("tinymce",{ref:"tinymceRef",attrs:{id:e.form.id,height:200},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-check",size:"mini"},on:{click:e.submitForm}},[e._v("保存")])],1)],1)],1)],1)],1)],1)])])],1),t("select-flow-def",{on:{getData:e.getData},model:{value:e.openShow,callback:function(t){e.openShow=t},expression:"openShow"}})],1)},i=[],r=n("c7eb"),o=n("1da1"),s=(n("4de4"),n("b0c0"),n("b64b"),n("d3b7"),n("fef2")),l=function(){var e=this,t=e._self._c;return e.refresh?t("el-dialog",{attrs:{id:"size","append-to-body":"",title:"选择流程定义",visible:e.isShow,width:"1000px",top:"20px","close-on-click-modal":!1},on:{"update:visible":function(t){e.isShow=t},close:e.hide}},[t("el-card",[t("el-row",{staticStyle:{display:"flex"}},[t("el-col",{staticClass:"box-left"},[t("div",{staticClass:"scroll-left"},[t("div",{staticClass:"treeList"},[e.isShow?t("el-tree",{ref:"orgTree",attrs:{"node-key":"id",data:e.categoryList,props:e.defaultProps,"expand-on-click-node":!1,"highlight-current":"","default-expand-all":""},on:{"node-click":e.handleCategoryClick}}):e._e()],1)])]),t("el-col",{staticClass:"box-right"},[t("div",{staticStyle:{background:"#fff","margin-top":"-8px"}},[t("div",{staticClass:"scroll-box"},[t("div",{staticClass:"tableContainer treeList"},[t("div",{staticClass:"body"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"selectMultipleTable",attrs:{data:e.definitionList,"row-key":"id"},on:{"row-click":e.handleSingleSelected}},[t("el-table-column",{attrs:{label:"",width:"30",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-radio",{attrs:{label:n.row.id},model:{value:e.selectedUserId,callback:function(t){e.selectedUserId=t},expression:"selectedUserId"}},[e._v(" "+e._s()+" ")])]}}],null,!1,2279015873)}),t("el-table-column",{attrs:{prop:"name",label:"流程名称",align:"center"}}),t("el-table-column",{attrs:{prop:"key",label:"流程标识",align:"center"}}),t("el-table-column",{attrs:{label:"流程版本",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-tag",{attrs:{size:"medium"}},[e._v("v"+e._s(n.row.version))])]}}],null,!1,876513839)})],1),t("ns-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}})],1)])])])])],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.hide}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("保 存")])],1)],1):e._e()},c=[],u=(n("e9c4"),n("db18")),d={props:{value:{type:Boolean,required:!0},enterParam:{type:Object,default:function(){return{}}}},data:function(){return{loading:!1,isShow:!1,refresh:!0,queryParams:{pageNum:1,pageSize:20,categoryId:null},total:0,definitionList:[],defaultProps:{children:"children",label:"categoryName"},categoryList:[],selectedUserId:"",selectedData:{}}},watch:{value:function(e){this.isShow=e,e&&(this.refresh=!0,this.getTenantCategoryList())},isShow:function(e){this.$emit("input",e)}},methods:{hide:function(){this.resetForm("queryForm"),this.$refs.selectMultipleTable.clearSelection(),this.selectedData={},this.selectedUserId="",this.refresh=!1,this.isShow=!1},handleRefresh:function(){this.resetForm("queryForm"),this.handleQuery()},handleCategoryClick:function(e){this.queryParams.categoryId=e.id,this.handleQuery()},getTenantCategoryList:function(){var e=this;Object(s["f"])({status:0}).then((function(t){e.categoryList=t.data.items,e.categoryList&&e.categoryList.length>0&&(e.$nextTick((function(){e.$refs.orgTree.setCurrentKey(e.categoryList[0].id)})),e.queryParams.categoryId=e.categoryList[0].id,e.handleQuery())}))},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},getList:function(){var e=this;this.loading=!0,Object(u["d"])(this.queryParams).then((function(t){e.loading=!1,0==t.code&&(e.total=t.data.total,e.definitionList=t.data.items)})).catch((function(){e.loading=!1}))},handleSingleSelected:function(e){this.selectedUserId=e.id,this.selectedData={key:e.key,name:e.name}},handleSubmit:function(){this.selectedUserId?(this.$emit("getData",JSON.stringify(this.selectedData)),this.hide()):this.$alert("请选择!","提醒",{confirmButtonText:"确定"})}}},m=d,p=(n("1a95"),n("2877")),f=Object(p["a"])(m,l,c,!1,null,"427d9c94",null),h=f.exports,g=function(){var e=this,t=e._self._c;return t("div",{staticClass:"tinymce-container",class:{fullscreen:e.fullscreen},style:{width:e.containerWidth}},[t("textarea",{staticClass:"tinymce-textarea",attrs:{id:e.tinymceId}}),e._v(" "),t("div",{staticClass:"editor-custom-btn-container"},[t("editorImage",{staticClass:"editor-upload-btn",attrs:{color:"#1890ff"},on:{successCBK:e.imageSuccessCBK}})],1)])},b=[],y=(n("a9e3"),n("b680"),n("ac1f"),n("00b4"),n("159b"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"upload-container"},[t("el-button",{style:{background:e.color,borderColor:e.color},attrs:{icon:"el-icon-upload",size:"mini",type:"primary"},on:{click:function(t){e.dialogVisible=!0}}},[e._v(" 插入图片 ")]),t("el-dialog",{attrs:{title:"图片上传","modal-append-to-body":!1,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-card",[t("el-upload",{staticClass:"editor-slide-upload",attrs:{multiple:!0,"file-list":e.fileList,"show-file-list":!0,"on-remove":e.handleRemove,"on-exceed":e.handexceed,"before-upload":e.beforeUpload,"http-request":e.upload,limit:5,action:"","list-type":"picture-card"}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v(" 点击上传 ")])],1),t("div",{staticStyle:{width:"100%","text-align":"center"}},[e._v(" 支持：上传照片,大小限制2M,一次最多上传5张 ")]),t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v(" 取消 ")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v(" 确认 ")])],1)],1)],1)}),v=[],w=(n("a434"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("b775")),x={uploadFile:"/adm-service/system/file/upl",gainBaseUrl:"/file/gainBaseUrl",dwlFile:"/adm-service/system/file/dwl"};function k(e){return w["a"].post(x.uploadFile,e,{timeout:3e5})}var C={name:"EditorSlideUpload",props:{color:{type:String,default:"#1890ff"}},data:function(){return{baseUrl:"",dialogVisible:!1,listObj:{},fileList:[]}},methods:{upload:function(e,t){var n=this,a=new FormData;a.append("busSubType","1702"),a.append("file",e.file),k(a).then((function(t){0===t.code?(n.$message.success("上传成功"),n.fileList.push({name:e.file.fileName,url:"/prod-api/open-service/system/file/image?fileId="+t.data.fileId})):n.$message.error("上传失败")}))},handleSubmit:function(){var e=[];for(var t in this.fileList){var n=this.fileList[t].url;e.push({url:n})}this.$emit("successCBK",e),this.listObj={},this.fileList=[],this.dialogVisible=!1},handleRemove:function(e,t){this.fileList.splice(this.fileList.indexOf(e),1)},handexceed:function(e,t){this.$message.warning("当前限制上传 5 个图片")},beforeUpload:function(e){var t=["bmp","jpg","png","gif","svg","psd","jpeg","webp"],n=e.name.substring(e.name.lastIndexOf(".")+1),a=e.size/1024/1024<2;return-1===t.indexOf(n)?(this.$message({message:"上传文件只能是bmp、jpg、png、gif、svg、psd、jpeg、webp格式!",type:"warning"}),!1):a||(this.$message({message:"上传文件大小不能超过 2M!",type:"warning"}),!1)}}},D=C,S=(n("6343"),Object(p["a"])(D,y,v,!1,null,"269e0e34",null)),T=S.exports,E=["advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr insertdatetime link lists nonbreaking noneditable pagebreak paste print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"],L=E,I=["searchreplace bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap preview anchor pagebreak insertdatetime media table emoticons forecolor backcolor fullscreen"],_=I;n("b85c");var O={name:"Tinymce",components:{editorImage:T},props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{type:String,default:"file edit insert view format table"},height:{type:[Number,String],required:!1,default:360},width:{type:[Number,String],required:!1,default:"auto"}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id,fullscreen:!1,languageTypeList:{en:"en",zh:"zh_CN",es:"es_MX",ja:"ja"}}},computed:{containerWidth:function(){var e=this.width;return/^[\d]+(\.[\d]+)?$/.test(e)?"".concat(e,"px"):e}},watch:{value:function(e){var t=this;console.log("tinymc :",e,this.hasInit,this.hasChange),!this.hasChange&&this.hasInit&&this.$nextTick((function(){return window.tinymce.get(t.tinymceId).setContent(e||"")}))}},mounted:function(){this.initTinymce()},activated:function(){window.tinymce&&this.initTinymce()},deactivated:function(){this.destroyTinymce()},destroyed:function(){this.destroyTinymce()},methods:{initTinymce:function(){var e=this,t=this;window.tinymce.init({selector:"#".concat(this.tinymceId),language:"zh_CN",height:this.height,body_class:"panel-body ",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:_,menubar:this.menubar,plugins:L,end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["www.tinymce.com","codepen.io"],default_link_target:"_blank",link_title:!1,nonbreaking_force_tab:!0,init_instance_callback:function(n){t.value&&n.setContent(t.value),t.hasInit=!0,n.on("NodeChange Change KeyUp SetContent",(function(){e.hasChange=!0,e.$emit("input",n.getContent())}))},setup:function(e){e.on("FullscreenStateChanged",(function(e){t.fullscreen=e.state}))},convert_urls:!1,images_upload_handler:function(e,t,n,a){}})},destroyTinymce:function(){var e=window.tinymce.get(this.tinymceId);this.fullscreen&&e.execCommand("mceFullScreen"),e&&e.destroy()},setContent:function(e){console.log("value:",e),window.tinymce.get(this.tinymceId).setContent(e)},getContent:function(){window.tinymce.get(this.tinymceId).getContent()},imageSuccessCBK:function(e){var t=this;e.forEach((function(e){return window.tinymce.get(t.tinymceId).insertContent('<img style="width:100%;" src="'.concat(e.url,'" >'))}))}}},P=O,A=(n("4208"),Object(p["a"])(P,g,b,!1,null,"dd6dc0c6",null)),N=A.exports,j={props:{forward:Function},components:{SelectFlowDef:h,Tinymce:N},watch:{categoryName:function(e){this.$refs.tree.filter(e)}},data:function(){return{categoryName:null,defaultProps:{children:"children",label:"categoryName"},nodeKey:"",loading:!1,categoryList:[],queryParams:{procCode:null},form:{procCode:"",procName:"",procDefKey:"",procDefName:"",approveUrl:"",status:0,remark:""},rules:{procDefName:[{required:!0,message:"请选择流程定义",trigger:"blur"}],approveUrl:[{required:!0,message:"审批路由地址不能为空",trigger:"blur"}]},openShow:!1}},computed:{},created:function(){var e=this;return Object(o["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getTenantCategoryList();case 2:case"end":return t.stop()}}),t)})))()},methods:{filterNode:function(e,t,n){return!e||this.chooseNode(e,t,n)},chooseNode:function(e,t,n){if(-1!==t.categoryName.indexOf(e)||-1!==t.categoryName.indexOf(e))return console.log("value 1>>>>",e,t,n),!0;var a=n.level;if(1===a)return!1;var i=n.parent,r=0;while(r<a-1){if(-1!==i.data.categoryName.indexOf(e))return console.log("value 2>>>>",e,t,n),!0;i=i.parent,r++}return!1},handleCategoryClick:function(e,t){var n=this;1===t.level?e.children&&e.children.length>0&&(this.$nextTick((function(){n.nodeKey=e.children[0].id,n.$refs.tree.setCurrentKey(e.children[0].id)})),this.form.procCode=e.children[0].categoryCode,this.form.procName=e.children[0].categoryName,this.queryParams.procCode=e.children[0].categoryCode,this.handleQuery()):(this.form.procCode=e.categoryCode,this.form.procName=e.categoryName,this.queryParams.procCode=e.categoryCode,this.handleQuery())},getTenantCategoryList:function(){var e=this;Object(s["h"])({status:0}).then((function(t){if(e.categoryList=t.data.items,e.categoryList&&e.categoryList.length>0){var n=e.categoryList[0];n.children&&n.children.length>0&&(e.$nextTick((function(){e.nodeKey=n.children[0].id,e.$refs.tree.setCurrentKey(n.children[0].id)})),e.form.procCode=n.children[0].categoryCode,e.form.procName=n.children[0].categoryName,e.queryParams.procCode=n.children[0].categoryCode,e.handleQuery())}}))},getList:function(){var e=this;this.loading=!0,Object(s["g"])(this.queryParams).then((function(t){e.loading=!1,0==t.code&&(t.data?(e.form=t.data,null==e.form.remark&&(e.form.remark="")):(e.form.procDefKey="",e.form.procDefName="",e.form.approveUrl="",e.form.remark="",e.status=0),e.$refs.tinymceRef.setContent(e.form.remark))})).catch((function(){e.loading=!1}))},reset:function(){this.resetForm("form")},handleQuery:function(){this.getList()},handleSelect:function(){this.openShow=!0},getData:function(e){var t=JSON.parse(e);this.form.procDefName=t.name,this.form.procDefKey=t.key},submitForm:function(){var e=this;this.$refs["queryForm"].validate((function(t){t&&Object(s["d"])(e.form).then((function(t){e.$message.success("保存成功！")})).catch((function(){e.$message.error("保存失败！")}))}))}}},M=j,z=(n("a3e5"),Object(p["a"])(M,a,i,!1,null,"40933658",null));t["default"]=z.exports},"169b":function(e,t,n){},"1a95":function(e,t,n){"use strict";n("c1bc1")},"1f81":function(e,t,n){},"223f":function(e,t,n){"use strict";n.r(t);n("b0c0");var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"tabel-container"},[t("el-row",{staticStyle:{display:"flex"}},[t("el-col",{staticClass:"box-left"},[t("div",{staticClass:"box-top"},[t("el-input",{staticStyle:{"margin-bottom":"20px"},attrs:{placeholder:"请输入分类名称",clearable:"",size:"small","prefix-icon":"el-icon-search"},model:{value:e.categoryName,callback:function(t){e.categoryName=t},expression:"categoryName"}})],1),t("div",{staticClass:"scroll-box"},[t("div",{staticClass:"treeList"},[t("div",{staticStyle:{padding:"0 10px"}},[t("el-tree",{ref:"tree",staticStyle:{display:"inline-block","min-width":"180px"},attrs:{data:e.categoryList,props:e.defaultProps,"expand-on-click-node":!1,"filter-node-method":e.filterNode,"default-expand-all":""},on:{"node-click":e.handleCategoryClick}})],1)])])]),t("el-col",{staticClass:"box-right"},[t("div",{staticClass:"container"},[t("div",{staticClass:"treeList"},[t("el-card",{staticClass:"mb10",attrs:{shadow:"never"}},[t("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[t("el-form-item",{attrs:{label:"名称",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入名称",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery.apply(null,arguments)}},model:{value:e.queryParams.name,callback:function(t){e.$set(e.queryParams,"name",t)},expression:"queryParams.name"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),t("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1)],1),t("el-card",{staticClass:"mb10",attrs:{shadow:"never"}},[t("div",{staticClass:"tool-rows mb10"},[t("div"),t("div",[t("el-button",{attrs:{type:"success",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:e.handleLoadXmlAdd}},[e._v("新增")])],1)]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{fit:"",data:e.definitionList},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t("el-table-column",{attrs:{label:"流程名称",align:"center",width:"180","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleReadImage(n.row.deploymentId)}}},[t("span",[e._v(e._s(n.row.name))])])]}}])}),t("el-table-column",{attrs:{label:"流程标识",align:"center",prop:"key",width:"200","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{label:"流程分类",align:"center",prop:"categoryName","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{label:"挂载表单",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[n.row.formId?t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleForm(n.row.formId)}}},[t("span",[e._v(e._s(n.row.formName))])]):t("label",[e._v("暂无表单")])]}}])}),t("el-table-column",{attrs:{label:"流程版本",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-tag",{attrs:{size:"medium"}},[e._v("v"+e._s(n.row.version))])]}}])}),t("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[1===n.row.suspensionState?t("el-tag",{attrs:{type:"success"}},[e._v("激活")]):e._e(),2===n.row.suspensionState?t("el-tag",{attrs:{type:"warning"}},[e._v("挂起")]):e._e()]}}])}),t("el-table-column",{attrs:{label:"部署时间",align:"center",prop:"deploymentTime",width:"160","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-dropdown",[t("span",{staticClass:"el-dropdown-link"},[e._v(" 更多操作"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{icon:"el-icon-edit-outline"},nativeOn:{click:function(t){return e.handleLoadXml(n.row)}}},[e._v(" 编辑 ")]),t("el-dropdown-item",{attrs:{icon:"el-icon-delete"},nativeOn:{click:function(t){return e.handleDelete(n.row)}}},[e._v(" 删除 ")])],1)],1)]}}])})],1),t("ns-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}})],1)],1)])])],1),t("el-dialog",{attrs:{title:e.title,visible:e.open,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"看看",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入看看"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),t("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1),t("el-dialog",{attrs:{title:e.upload.title,visible:e.upload.open,width:"400px","append-to-body":""},on:{"update:visible":function(t){return e.$set(e.upload,"open",t)}}},[t("el-upload",{ref:"upload",attrs:{limit:1,accept:".xml",headers:e.upload.headers,action:e.upload.url+"?name="+e.upload.name+"&category="+e.upload.category,disabled:e.upload.isUploading,"on-progress":e.handleFileUploadProgress,"on-success":e.handleFileSuccess,"auto-upload":!1,drag:""}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v(" 将文件拖到此处，或 "),t("em",[e._v("点击上传")])]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 流程名称： "),t("el-input",{model:{value:e.upload.name,callback:function(t){e.$set(e.upload,"name",t)},expression:"upload.name"}}),e._v(" 流程分类： "),t("treeselect",{attrs:{options:e.categoryList,normalizer:e.normalizer,"show-count":!0,placeholder:"选择所属分类"},model:{value:e.upload.category,callback:function(t){e.$set(e.upload,"category",t)},expression:"upload.category"}})],1),t("div",{staticClass:"el-upload__tip",staticStyle:{color:"red"},attrs:{slot:"tip"},slot:"tip"},[e._v("提示：仅允许导入“bpmn20.xml”格式文件！")])]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.submitFileForm}},[e._v("确 定")]),t("el-button",{on:{click:function(t){e.upload.open=!1}}},[e._v("取 消")])],1)],1),t("el-dialog",{attrs:{title:e.readImage.title,visible:e.readImage.open,width:"70%","append-to-body":""},on:{"update:visible":function(t){return e.$set(e.readImage,"open",t)}}},[t("flow",{attrs:{xmlData:e.xmlData}})],1),t("el-dialog",{attrs:{title:e.formTitle,visible:e.formConfOpen,width:"50%","append-to-body":""},on:{"update:visible":function(t){e.formConfOpen=t}}},[t("div",{staticClass:"test-form"})]),t("el-dialog",{attrs:{title:e.formDeployTitle,visible:e.formDeployOpen,width:"60%","append-to-body":""},on:{"update:visible":function(t){e.formDeployOpen=t}}},[t("el-row",{attrs:{gutter:24}},[t("el-col",{attrs:{span:10,xs:24}},[t("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.formList,border:"","highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[t("el-table-column",{attrs:{label:"表单编号",align:"center",prop:"formId"}}),t("el-table-column",{attrs:{label:"表单名称",align:"center",prop:"formName"}}),t("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.submitFormDeploy(n.row)}}},[e._v("确定")])]}}])})],1),t("ns-pagination",{directives:[{name:"show",rawName:"v-show",value:e.formTotal>0,expression:"formTotal>0"}],attrs:{small:"",layout:"prev, pager, next",total:e.formTotal,page:e.formQueryParams.pageNum,limit:e.formQueryParams.pageSize},on:{"update:page":function(t){return e.$set(e.formQueryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.formQueryParams,"pageSize",t)},pagination:e.listflowableFormDeploy}})],1),t("el-col",{attrs:{span:14,xs:24}},[e.currentRow?t("div",[t("parser",{key:(new Date).getTime(),attrs:{"form-conf":e.currentRow}})],1):e._e()])],1)],1)],1)},i=[],r=n("c7eb"),o=n("1da1"),s=(n("4de4"),n("d81d"),n("b64b"),n("d3b7"),n("fef2")),l=n("db18"),c=n("5f87"),u=n("b775");function d(e){return Object(u["a"])({url:"/workflow/flowForm/list",method:"get",params:e})}function m(e){return Object(u["a"])({url:"/workflow/flowForm/"+e,method:"get"})}function p(e){return Object(u["a"])({url:"/workflow/flowForm/addDeployForm",method:"post",data:e})}var f=n("6cbd"),h=n("5aee"),g=n("ca17"),b=n.n(g),y=(n("542c"),{props:{forward:Function},components:{IconSelect:h["a"],flow:f["default"],Treeselect:b.a},watch:{categoryName:function(e){this.$refs.tree.filter(e)}},data:function(){return{categoryName:null,defaultProps:{children:"children",label:"categoryName"},activeCategoryId:void 0,deptId:void 0,filePicList:[],tenantFilterText:"",authOpen:!1,tenantData:[],tenantData2:[],activeOrg:"0",loading:!1,categoryList:[],pageMenuOptions:[],menuOptions:[],title:"",open:!1,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,definitionList:[],visibleOptions:[],statusOptions:[],formConfOpen:!1,formTitle:"",formDeployOpen:!1,formDeployTitle:"",formList:null,formTotal:0,formConf:{},readImage:{open:!1,src:""},upload:{open:!1,title:"",isUploading:!1,name:null,category:null,headers:{Authorization:"Bearer "+Object(c["c"])()},url:"/prod-api/workflow/flowDefinition/import"},queryParams:{pageNum:1,pageSize:10,name:null,categoryId:null},formQueryParams:{pageNum:1,pageSize:10},formDeployParam:{formId:0,deployId:null},currentRow:null,xmlData:"",form:{},rules:{}}},computed:{},created:function(){var e=this;return Object(o["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getTenantCategoryList();case 2:e.handleQuery();case 3:case"end":return t.stop()}}),t)})))()},methods:{normalizer:function(e){return e.children&&!e.children.length&&delete e.children,{id:e.id,label:e.categoryName,children:e.children}},filterNode:function(e,t){return!e||-1!==t.categoryName.indexOf(e)},handleCategoryClick:function(e){this.activeCategoryId=e.id,this.queryParams.categoryId=e.id,this.handleQuery()},getTenantCategoryList:function(){var e=this;this.loading=!0,Object(s["f"])().then((function(t){e.categoryList=t.data.items,e.loading=!1}))},getList:function(){var e=this;this.loading=!0,Object(l["d"])(this.queryParams).then((function(t){e.definitionList=t.data.items,e.total=t.data.total,e.loading=!1})).catch((function(){e.loading=!1}))},cancel:function(){this.open=!1,this.reset()},reset:function(){this.form={name:null,categoryId:null,key:null,tenantId:null,deployTime:null,derivedFrom:null,derivedFromRoot:null,parentDeploymentId:null,engineVersion:null},this.resetForm("form")},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleSelectionChange:function(e){this.ids=e.map((function(e){return e.id})),this.single=1!==e.length,this.multiple=!e.length},handleAdd:function(){this.reset(),this.open=!0,this.title="添加流程定义"},handleLoadXmlAdd:function(){this.forward("Form",{type:"add"})},handleLoadXml:function(e){this.forward("Form",{type:"edit",deployId:e.deploymentId})},handleReadImage:function(e){var t=this;this.readImage.title="流程图",this.readImage.open=!0,Object(l["e"])({deployId:e}).then((function(e){t.xmlData=e.data}))},handleForm:function(e){var t=this;m(e).then((function(e){t.formTitle="表单详情",t.formConfOpen=!0,t.formConf=JSON.parse(e.data.formContent)}))},handleDefinitionStart:function(e){},handleAddForm:function(e){this.formDeployParam.deployId=e.deploymentId,this.listflowableFormDeploy()},listflowableFormDeploy:function(){var e=this;d(this.formQueryParams).then((function(t){e.formList=t.rows,e.formTotal=t.total,e.formDeployOpen=!0,e.formDeployTitle="挂载表单"}))},submitFormDeploy:function(e){var t=this;this.formDeployParam.formId=e.formId,p(this.formDeployParam).then((function(e){t.msgSuccess(e.msg),t.formDeployOpen=!1,t.getList()}))},handleCurrentChange:function(e){e&&(this.currentRow=JSON.parse(e.formContent))},handleUpdateSuspensionState:function(e){var t=this,n=1;1===e.suspensionState&&(n=2);var a={deployId:e.deploymentId,state:n};Object(l["i"])(a).then((function(e){t.msgSuccess(e.msg),t.getList()}))},handleUpdate:function(e){var t=this;this.reset();var n=e.id||this.ids;getDeployment(n).then((function(e){t.form=e.data,t.open=!0,t.title="修改流程定义"}))},submitForm:function(){var e=this;this.$refs["form"].validate((function(t){t&&(null!=e.form.id?Object(l["h"])(e.form).then((function(t){e.msgSuccess("修改成功"),e.open=!1,e.getList()})):Object(l["a"])(e.form).then((function(t){e.msgSuccess("新增成功"),e.open=!1,e.getList()})))}))},handleDelete:function(e){var t=this,n={deployId:e.deploymentId};this.$confirm('是否确认删除流程定义编号为"'+e.name+"_v"+e.version+'"的数据项?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(l["b"])(n)})).then((function(){t.getList(),t.msgSuccess("删除成功")}))},handleExport:function(){var e=this,t=this.queryParams;this.$confirm("是否确认导出所有流程定义数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(l["c"])(t)})).then((function(t){e.download(t.msg)}))},handleImport:function(){this.upload.title="bpmn20.xml文件导入",this.upload.open=!0},handleFileUploadProgress:function(e,t,n){this.upload.isUploading=!0},handleFileSuccess:function(e,t,n){this.upload.open=!1,this.upload.isUploading=!1,this.$refs.upload.clearFiles(),this.$message(e.msg),this.getList()},submitFileForm:function(){this.$refs.upload.submit()}}}),v=y,w=(n("7753"),n("2877")),x=Object(w["a"])(v,a,i,!1,null,"3f5b2de7",null);t["default"]=x.exports},"22de":function(e,t,n){"use strict";n("d2bc")},"26fc":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJgAAACKCAMAAABhAnODAAABzlBMVEUAAAD8/f/////////////3+v7////4+/7////////9///3+v7////////////4+v7+///////6/P/+/v/+/v/////5+/7////3+f72+v7y9/7+///7/f/////////////3+v76/P/7/f/4/P/9///////o8vz3+/73+f73+v7////4+/7////////3+//3+/7////+/v/////+/v/////o8fz9/v/p8f3o8fz3+/7////r8/33+v74+v72+v70+P7////+///3+v72+v7t9P3w9v3x9/7////+///7/f/////////////////3+v7p8v3////p8vv4+//////5+//r8/z4+//p8vz////6/P/4+v/////5/P7////8/P7////6/P/2+//8/f/////8///8///////n8fz2+v7////p8vz2+f73+v7////u9f7r9P3z+P32+f7////2+f73+v3////////2+v3////4+//t9P31+v78/P/4+//4+/7t9P35+//////////o8fz////0+P7o8fzo8fzo8Pv////z9/3o8f3z9//////w9/7w9/73+v/////p8v35/P7o8f3o8P3////n8Pv2+f3z+P4909UsAAAAlnRSTlMA/fumA/3h+PTlC/sG/vrz29a8NRLv7+fmzMJOLBj26cS+VB8O/fvp39TNwsG/u6CagmdbQP759O7s3dzZ0tDLysjIwcG/u6h1OiEB8evi4t/X1tHQ0M3GxcS4r5WNiX17c0UpJBsJ+O7t6OTc2MzKvra1raeflpBtbVtNLxX01tLDura0tKqai4WCbWZhSz4yFu/jfHnJ+3wGAAAFOElEQVR42u3cB1MTQRjG8TXehZBC6CQhkEBCbyJdelVUQDoCKiBFQJqCgoC99/qyfFshCId4yS2X3cs6k98n+E9y7HMz2QGxNpV+M8+aXTg6nuw0Ik5Mt4/fn8fH2PKKxh7FxaNQmiwZtZuwvDv21TEn0p53YmylCgfS1wuRHqQlwfmxKEfEAT2+roc9MZp9o982iwutWIkt7yocGJpGzJnjNlazMYHaxgw4MiIgljzpD90RmESEewH+cg6x4t0omseEstJccNItxMh9jEVbrbu5uakmEQfUc70cZJxHTIzjYxJrmpoLm+2dMl+ryZ0L8nTJiIF22QPU1GlPGy7Me5olHh6nsXrwK7UdUbc9r/BQ5eQNDxe6065CIB23EWVCISZg0oMCfQqi6z0mMQCKer2IpgkRE8gBAgVmRM9UFSZg7QASF6/Q26AmTKIPZDE8aB9iEnYgdBZRko5J2Axah01aMQExBjQOm67FJK6D1mFFmESNTuuwj2QvX9dA47CtCMIvUuuwomyR6KTQPGynrLrl1XBt4M8tyxWCsAOVS21t9jvYj0YIRZgks7qlzd2J/5EHIQyTVC62NvdEYEm2gY8wn8wnDkddoq/L1AschR2YW3TU22KBvzCfcl7DzoTDwmHhsHBYOCwc9r+GpUYeOitwFXbMOV7DoJjXMDjPa1hGOqdhUF7KaRgkbHEaBkmXOQ2D6G1Ow6DByGkYPOc1TBcOC4eFwwi1L1VwGDb9KRdA97S1f4arsMkbs0fvwgOt3Zl8hAmb9yzwl4Sm1u6yUIfFX7oAclzuluoQhn1dSwX/9I6WrlCEmUsaQVH0csuctmGedy4gk9HTNlipVdjEiA5OI6qvbbCCeZh3fQFUMKxYmIY5HxhAjegGAHZhQnoBqKIfsgC7sJRbkaBK0jMd0OJCJ5VejAJVEvJTgRbDO+/JT6tID6oYCq4CLVGj39BJq1gciD19W1R+B9CiW/Ogf3zG+8S607VlDEUCNSNyN92MR5dZxb7Ya0Co4QJQ8zwOybmJjxHriNpyF4CaxlIka8uET8iJVfg0YnqBmphkJE9owhKFNumYp+VCiYD82MB+9MRGgwx9owVoSVo3I3+mrNi/mrSTba4hHdCSMGYMfD9ZIt/G6Ji/GY8CSMbK7v5pM+RTPOYfpKBAjJ3Yh6At6lkH0JKxdlnxOiQpUxJQM+JECuJMmNQPoKUgDikRBjApK1DSMEF0M5/YLFARk44IeKyYVBbQoP8kIBKvMLFyCJ5r3Ux6EVjLDyzhlhGR8drIjwoIVqp0zCsaxcQSgz7mpxCxdlGrLsvZSUROqNXgyZfOU3KXMLEqCu+n5FaqMCHRAqolnRfQKe3MLC3bGD9hhmKjut8fy/qXs7GSCFBJdy4lmJ+Su1vvsgl7eTvoWwHVjhzqbxW5pXQueMw56kQsKwNUuFZyhd6VmO+OOhOdJ3/2kpny7aaKRXtE0EdF1I14Jpe6++utwTz5louXmd0HK3tSn6i2qyCO8UW16nrfMJxRMT+MwiRd9bbHKuaHYZhk97Tzw1+Yb344DNufHw7D9ueHwzD93vxwGJawPz/8hfnmh78w3/xwGJbvmx/uwg7nh7MwaX64CpPmh4EKFWHS/DBkfPQiU1XYPSdiLf7DYBlxmDQ/mvD86icLk+ZHM863XYph0vxo6sqXN5UKYdL8aMz8+XWFTJja+WH9Z7pLNj/sbX8YlAnzzU/IeX52Hws7mh8ufH3bdSzMUMzN/85DSPjzZ7rrmx++mDdfz+zs7s0Ph7yO9yjsyG/PhVsZ2R0KAAAAAABJRU5ErkJggg=="},2730:function(e){e.exports=JSON.parse('{"name":"Flowable","uri":"http://flowable.org/bpmn","prefix":"flowable","xml":{"tagAlias":"lowerCase"},"associations":[],"types":[{"name":"InOutBinding","superClass":["Element"],"isAbstract":true,"properties":[{"name":"source","isAttr":true,"type":"String"},{"name":"sourceExpression","isAttr":true,"type":"String"},{"name":"target","isAttr":true,"type":"String"},{"name":"businessKey","isAttr":true,"type":"String"},{"name":"local","isAttr":true,"type":"Boolean","default":false},{"name":"variables","isAttr":true,"type":"String"}]},{"name":"In","superClass":["InOutBinding"],"meta":{"allowedIn":["bpmn:CallActivity"]}},{"name":"Out","superClass":["InOutBinding"],"meta":{"allowedIn":["bpmn:CallActivity"]}},{"name":"AsyncCapable","isAbstract":true,"extends":["bpmn:Activity","bpmn:Gateway","bpmn:Event"],"properties":[{"name":"async","isAttr":true,"type":"Boolean","default":false},{"name":"asyncBefore","isAttr":true,"type":"Boolean","default":false},{"name":"asyncAfter","isAttr":true,"type":"Boolean","default":false},{"name":"exclusive","isAttr":true,"type":"Boolean","default":true}]},{"name":"flowable:in","superClass":["Element"],"properties":[{"name":"source","type":"string","isAttr":true},{"name":"target","type":"string","isAttr":true}]},{"name":"flowable:out","superClass":["Element"],"properties":[{"name":"source","type":"string","isAttr":true},{"name":"target","type":"string","isAttr":true}]},{"name":"BoundaryEvent","superClass":["CatchEvent"],"properties":[{"name":"cancelActivity","default":true,"isAttr":true,"type":"Boolean"},{"name":"attachedToRef","type":"Activity","isAttr":true,"isReference":true}]},{"name":"JobPriorized","isAbstract":true,"extends":["bpmn:Process","flowable:AsyncCapable"],"properties":[{"name":"jobPriority","isAttr":true,"type":"String"}]},{"name":"SignalEventDefinition","isAbstract":true,"extends":["bpmn:SignalEventDefinition"],"properties":[{"name":"async","isAttr":true,"type":"Boolean","default":false}]},{"name":"ErrorEventDefinition","isAbstract":true,"extends":["bpmn:ErrorEventDefinition"],"properties":[{"name":"errorCodeVariable","isAttr":true,"type":"String"},{"name":"errorMessageVariable","isAttr":true,"type":"String"}]},{"name":"Error","isAbstract":true,"extends":["bpmn:Error"],"properties":[{"name":"flowable:errorMessage","isAttr":true,"type":"String"}]},{"name":"PotentialStarter","superClass":["Element"],"properties":[{"name":"resourceAssignmentExpression","type":"bpmn:ResourceAssignmentExpression"}]},{"name":"UserTask","isAbstract":true,"extends":["bpmn:UserTask"],"properties":[{"name":"timerEventDefinition","type":"Expression"},{"name":"multiInstanceLoopCharacteristics","type":"MultiInstanceLoopCharacteristics"}]},{"name":"StartEvent","isAbstract":true,"extends":["bpmn:StartEvent"],"properties":[{"name":"timerEventDefinition","type":"Expression"}]},{"name":"FormSupported","isAbstract":true,"extends":["bpmn:StartEvent","bpmn:UserTask"],"properties":[{"name":"formHandlerClass","isAttr":true,"type":"String"},{"name":"formKey","isAttr":true,"type":"String"}]},{"name":"TemplateSupported","isAbstract":true,"extends":["bpmn:Process","bpmn:FlowElement"],"properties":[{"name":"modelerTemplate","isAttr":true,"type":"String"}]},{"name":"Initiator","isAbstract":true,"extends":["bpmn:StartEvent"],"properties":[{"name":"initiator","isAttr":true,"type":"String"}]},{"name":"ScriptTask","isAbstract":true,"extends":["bpmn:ScriptTask"],"properties":[{"name":"resultVariable","isAttr":true,"type":"String"},{"name":"resource","isAttr":true,"type":"String"}]},{"name":"Process","isAbstract":true,"extends":["bpmn:Process"],"properties":[{"name":"candidateStarterGroups","isAttr":true,"type":"String"},{"name":"candidateStarterUsers","isAttr":true,"type":"String"},{"name":"versionTag","isAttr":true,"type":"String"},{"name":"historyTimeToLive","isAttr":true,"type":"String"},{"name":"isStartableInTasklist","isAttr":true,"type":"Boolean","default":true}]},{"name":"EscalationEventDefinition","isAbstract":true,"extends":["bpmn:EscalationEventDefinition"],"properties":[{"name":"escalationCodeVariable","isAttr":true,"type":"String"}]},{"name":"FormalExpression","isAbstract":true,"extends":["bpmn:FormalExpression"],"properties":[{"name":"resource","isAttr":true,"type":"String"}]},{"name":"Assignable","extends":["bpmn:UserTask"],"properties":[{"name":"candidateGroups","isAttr":true,"type":"String"},{"name":"dueDate","isAttr":true,"type":"String"},{"name":"followUpDate","isAttr":true,"type":"String"},{"name":"priority","isAttr":true,"type":"String"}]},{"name":"CallActivity","extends":["bpmn:CallActivity"],"properties":[{"name":"calledElementBinding","isAttr":true,"type":"String","default":"latest"},{"name":"calledElementVersion","isAttr":true,"type":"String"},{"name":"calledElementVersionTag","isAttr":true,"type":"String"},{"name":"calledElementTenantId","isAttr":true,"type":"String"},{"name":"caseRef","isAttr":true,"type":"String"},{"name":"caseBinding","isAttr":true,"type":"String","default":"latest"},{"name":"caseVersion","isAttr":true,"type":"String"},{"name":"caseTenantId","isAttr":true,"type":"String"},{"name":"variableMappingClass","isAttr":true,"type":"String"},{"name":"variableMappingDelegateExpression","isAttr":true,"type":"String"}]},{"name":"ServiceTaskLike","extends":["bpmn:ServiceTask","bpmn:BusinessRuleTask","bpmn:SendTask","bpmn:MessageEventDefinition"],"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"resultVariable","isAttr":true,"type":"String"}]},{"name":"ExclusiveGateway","isAbstract":true,"extends":["bpmn:ExclusiveGateway"],"properties":[{"name":"serviceClass","isAttr":true,"type":"String"}]},{"name":"DmnCapable","extends":["bpmn:BusinessRuleTask"],"properties":[{"name":"decisionRef","isAttr":true,"type":"String"},{"name":"decisionRefBinding","isAttr":true,"type":"String","default":"latest"},{"name":"decisionRefVersion","isAttr":true,"type":"String"},{"name":"mapDecisionResult","isAttr":true,"type":"String","default":"resultList"},{"name":"decisionRefTenantId","isAttr":true,"type":"String"}]},{"name":"ExternalCapable","extends":["flowable:ServiceTaskLike"],"properties":[{"name":"type","isAttr":true,"type":"String"},{"name":"topic","isAttr":true,"type":"String"}]},{"name":"TaskPriorized","extends":["bpmn:Process","flowable:ExternalCapable"],"properties":[{"name":"taskPriority","isAttr":true,"type":"String"}]},{"name":"Properties","superClass":["Element"],"meta":{"allowedIn":["*"]},"properties":[{"name":"values","type":"Property","isMany":true}]},{"name":"Property","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"name","type":"String","isAttr":true},{"name":"value","type":"String","isAttr":true}]},{"name":"Connector","superClass":["Element"],"meta":{"allowedIn":["flowable:ServiceTaskLike"]},"properties":[{"name":"inputOutput","type":"InputOutput"},{"name":"connectorId","type":"String"}]},{"name":"InputOutput","superClass":["Element"],"meta":{"allowedIn":["bpmn:FlowNode","flowable:Connector"]},"properties":[{"name":"inputOutput","type":"InputOutput"},{"name":"connectorId","type":"String"},{"name":"inputParameters","isMany":true,"type":"InputParameter"},{"name":"outputParameters","isMany":true,"type":"OutputParameter"}]},{"name":"InputOutputParameter","properties":[{"name":"name","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"},{"name":"definition","type":"InputOutputParameterDefinition"}]},{"name":"InputOutputParameterDefinition","isAbstract":true},{"name":"List","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"items","isMany":true,"type":"InputOutputParameterDefinition"}]},{"name":"Map","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"entries","isMany":true,"type":"Entry"}]},{"name":"Entry","properties":[{"name":"key","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"},{"name":"definition","type":"InputOutputParameterDefinition"}]},{"name":"Value","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"id","isAttr":true,"type":"String"},{"name":"name","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"}]},{"name":"Script","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"scriptFormat","isAttr":true,"type":"String"},{"name":"resource","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"}]},{"name":"Field","superClass":["Element"],"meta":{"allowedIn":["flowable:ServiceTaskLike","flowable:ExecutionListener","flowable:TaskListener"]},"properties":[{"name":"name","isAttr":true,"type":"String"},{"name":"expression","isAttr":true,"type":"expression"},{"name":"string","type":"string"},{"name":"stringValue","isAttr":true,"type":"String"}]},{"name":"string","superClass":["Element"],"meta":{"allowedIn":["flowable:Field"]},"properties":[{"name":"body","isBody":true,"type":"String"}]},{"name":"expression","superClass":["Element"],"meta":{"allowedIn":["flowable:Field"]},"properties":[{"name":"body","isBody":true,"type":"String"}]},{"name":"InputParameter","superClass":["InputOutputParameter"]},{"name":"OutputParameter","superClass":["InputOutputParameter"]},{"name":"Collectable","isAbstract":true,"extends":["bpmn:MultiInstanceLoopCharacteristics"],"superClass":["flowable:AsyncCapable"],"properties":[{"name":"collection","isAttr":true,"type":"String"},{"name":"elementVariable","isAttr":true,"type":"String"}]},{"name":"SequenceFlow","superClass":["FlowElement"],"properties":[{"name":"isImmediate","isAttr":true,"type":"Boolean"},{"name":"conditionExpression","type":"Expression"},{"name":"sourceRef","type":"FlowNode","isAttr":true,"isReference":true},{"name":"targetRef","type":"FlowNode","isAttr":true,"isReference":true}]},{"name":"MultiInstanceLoopCharacteristics","superClass":["LoopCharacteristics"],"properties":[{"name":"isSequential","default":false,"isAttr":true,"type":"Boolean"},{"name":"behavior","type":"MultiInstanceBehavior","default":"All","isAttr":true},{"name":"loopCardinality","type":"Expression","xml":{"serialize":"xsi:type"}},{"name":"loopDataInputRef","type":"ItemAwareElement","isReference":true},{"name":"loopDataOutputRef","type":"ItemAwareElement","isReference":true},{"name":"inputDataItem","type":"DataInput","xml":{"serialize":"property"}},{"name":"outputDataItem","type":"DataOutput","xml":{"serialize":"property"}},{"name":"complexBehaviorDefinition","type":"ComplexBehaviorDefinition","isMany":true},{"name":"completionCondition","type":"Expression","xml":{"serialize":"xsi:type"}},{"name":"oneBehaviorEventRef","type":"EventDefinition","isAttr":true,"isReference":true},{"name":"noneBehaviorEventRef","type":"EventDefinition","isAttr":true,"isReference":true}]},{"name":"FailedJobRetryTimeCycle","superClass":["Element"],"meta":{"allowedIn":["flowable:AsyncCapable","bpmn:MultiInstanceLoopCharacteristics"]},"properties":[{"name":"body","isBody":true,"type":"String"}]},{"name":"ExecutionListener","superClass":["Element"],"meta":{"allowedIn":["bpmn:Task","bpmn:ServiceTask","bpmn:UserTask","bpmn:BusinessRuleTask","bpmn:ScriptTask","bpmn:ReceiveTask","bpmn:ManualTask","bpmn:ExclusiveGateway","bpmn:SequenceFlow","bpmn:ParallelGateway","bpmn:InclusiveGateway","bpmn:EventBasedGateway","bpmn:StartEvent","bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent","bpmn:EndEvent","bpmn:BoundaryEvent","bpmn:CallActivity","bpmn:SubProcess","bpmn:Process"]},"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"event","isAttr":true,"type":"String"},{"name":"script","type":"Script"},{"name":"fields","type":"Field","isMany":true}]},{"name":"TaskListener","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"event","isAttr":true,"type":"String"},{"name":"script","type":"Script"},{"name":"fields","type":"Field","isMany":true}]},{"name":"FormProperty","superClass":["Element"],"meta":{"allowedIn":["bpmn:StartEvent","bpmn:UserTask"]},"properties":[{"name":"id","type":"String","isAttr":true},{"name":"name","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"required","type":"String","isAttr":true},{"name":"readable","type":"String","isAttr":true},{"name":"writable","type":"String","isAttr":true},{"name":"variable","type":"String","isAttr":true},{"name":"expression","type":"String","isAttr":true},{"name":"datePattern","type":"String","isAttr":true},{"name":"default","type":"String","isAttr":true},{"name":"values","type":"Value","isMany":true}]},{"name":"FormData","superClass":["Element"],"meta":{"allowedIn":["bpmn:StartEvent","bpmn:UserTask"]},"properties":[{"name":"fields","type":"FormField","isMany":true},{"name":"businessKey","type":"String","isAttr":true}]},{"name":"FormField","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"label","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"datePattern","type":"String","isAttr":true},{"name":"defaultValue","type":"String","isAttr":true},{"name":"properties","type":"Properties"},{"name":"validation","type":"Validation"},{"name":"values","type":"Value","isMany":true}]},{"name":"Validation","superClass":["Element"],"properties":[{"name":"constraints","type":"Constraint","isMany":true}]},{"name":"Constraint","superClass":["Element"],"properties":[{"name":"name","type":"String","isAttr":true},{"name":"config","type":"String","isAttr":true}]},{"name":"ConditionalEventDefinition","isAbstract":true,"extends":["bpmn:ConditionalEventDefinition"],"properties":[{"name":"variableName","isAttr":true,"type":"String"},{"name":"variableEvent","isAttr":true,"type":"String"}]}],"emumerations":[]}')},"2e01":function(e,t,n){"use strict";n("ab42")},"345e":function(e,t,n){},4208:function(e,t,n){"use strict";n("345e")},"449f":function(e,t,n){},"464e":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t(e.curComponent,{tag:"component",attrs:{enterParams:e.enterParams,forward:e.forward}})},i=[],r=n("223f"),o=n("9369"),s={name:"WorkflowBpmn",components:{List:r["default"],Form:o["default"]},data:function(){return{curComponent:"List",enterParams:{}}},methods:{forward:function(e,t){this.curComponent=e,this.enterParams=t||{}}}},l=s,c=n("2877"),u=Object(c["a"])(l,a,i,!1,null,null,null);t["default"]=u.exports},"4b3b":function(e,t,n){var a={"./404":"8cdb","./404.vue":"8cdb","./biz/adm/workflow/bpmn":"464e","./biz/adm/workflow/bpmn/":"464e","./biz/adm/workflow/bpmn/form":"9369","./biz/adm/workflow/bpmn/form.vue":"9369","./biz/adm/workflow/bpmn/index":"464e","./biz/adm/workflow/bpmn/index.vue":"464e","./biz/adm/workflow/bpmn/list":"223f","./biz/adm/workflow/bpmn/list.vue":"223f","./biz/adm/workflow/category":"a497","./biz/adm/workflow/category/":"a497","./biz/adm/workflow/category/index":"a497","./biz/adm/workflow/category/index.vue":"a497","./biz/adm/workflow/config":"c9a7","./biz/adm/workflow/config/":"c9a7","./biz/adm/workflow/config/form":"b212","./biz/adm/workflow/config/form.vue":"b212","./biz/adm/workflow/config/index":"c9a7","./biz/adm/workflow/config/index.vue":"c9a7","./biz/adm/workflow/config/list":"114a","./biz/adm/workflow/config/list.vue":"114a","./biz/adm/workflow/task/record/flow":"6cbd","./biz/adm/workflow/task/record/flow.vue":"6cbd","./redirect":"ef3c","./redirect/":"ef3c","./redirect/index":"ef3c","./redirect/index.vue":"ef3c"};function i(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=r,e.exports=i,i.id="4b3b"},"5aee":function(e,t,n){"use strict";n("b0c0");var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"icon-body"},[t("el-input",{staticStyle:{position:"relative"},attrs:{clearable:"",placeholder:"请输入图标名称"},on:{clear:e.filterIcons},nativeOn:{input:function(t){return e.filterIcons.apply(null,arguments)}},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}},[t("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},slot:"suffix"})]),t("div",{staticClass:"icon-list"},e._l(e.iconList,(function(n,a){return t("div",{key:a,on:{click:function(t){return e.selectedIcon(n)}}},[t("svg-icon",{staticStyle:{height:"30px",width:"16px"},attrs:{"icon-class":n}}),t("span",[e._v(e._s(n))])],1)})),0)],1)},i=[],r=(n("4de4"),n("caad"),n("d3b7"),n("2532"),n("d81d"),n("ac1f"),n("466d"),n("ddb0"),n("51ff")),o=function(e){return e.keys()},s=/\.\/(.*)\.svg/,l=o(r).map((function(e){return e.match(s)[1]})),c=l,u={name:"IconSelect",data:function(){return{name:"",iconList:c}},methods:{filterIcons:function(){var e=this;this.iconList=c,this.name&&(this.iconList=this.iconList.filter((function(t){return t.includes(e.name)})))},selectedIcon:function(e){this.$emit("selected",e),document.body.click()},reset:function(){this.name="",this.iconList=c}}},d=u,m=(n("2e01"),n("2877")),p=Object(m["a"])(d,a,i,!1,null,"0273f142",null);t["a"]=p.exports},6343:function(e,t,n){"use strict";n("7126")},"6cbd":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("bpmn-modeler",{ref:"refNode",attrs:{xml:e.xmlData,"is-view":!0,taskList:e.taskData}})],1)},i=[],r=n("ae3a"),o={name:"Flow",components:{bpmnModeler:r["a"]},props:{xmlData:{type:String,default:""},taskData:{type:Array,default:function(){return[]}}},data:function(){return{}}},s=o,l=n("2877"),c=Object(l["a"])(s,a,i,!1,null,null,null);t["default"]=c.exports},7126:function(e,t,n){},7753:function(e,t,n){"use strict";n("a2b0")},8280:function(e,t,n){"use strict";n("169b")},"8cdb":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"wscn-http404-container"},[t("div",{staticClass:"wscn-http404"},[e._m(0),t("div",{staticClass:"bullshit"},[t("div",{staticClass:"bullshit__oops"},[e._v("OOPS!")]),e._m(1),t("div",{staticClass:"bullshit__headline"},[e._v(e._s(e.message))]),t("div",{staticClass:"bullshit__info"},[e._v("Please check that the URL you entered is correct, or click the button below to return to the homepage.")]),t("a",{staticClass:"bullshit__return-home",attrs:{href:""}},[e._v("Back to home")])])])])},i=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"pic-404"},[t("img",{staticClass:"pic-404__parent",attrs:{src:n("a36b"),alt:"404"}}),t("img",{staticClass:"pic-404__child left",attrs:{src:n("26fc"),alt:"404"}}),t("img",{staticClass:"pic-404__child mid",attrs:{src:n("26fc"),alt:"404"}}),t("img",{staticClass:"pic-404__child right",attrs:{src:n("26fc"),alt:"404"}})])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"bullshit__info"},[e._v("All rights reserved "),t("a",{staticStyle:{color:"#20a0ff"},attrs:{href:"https://wallstreetcn.com",target:"_blank"}},[e._v("wallstreetcn")])])}],r={name:"Page404",computed:{message:function(){return"The webmaster said that you can not enter this page..."}}},o=r,s=(n("dd53"),n("2877")),l=Object(s["a"])(o,a,i,!1,null,"c095f994",null);t["default"]=l.exports},"8f0e":function(e,t,n){},"934c":function(e,t,n){"use strict";n("1f81")},9369:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("bpmn-modeler",{ref:"refNode",attrs:{xml:e.xml,users:e.users,groups:e.groups,categorys:e.categorys,"is-view":!1},on:{save:e.save,showXML:e.showXML,dataType:e.dataType,close:e.close}}),e.xmlOpen?t("el-dialog",{attrs:{title:e.xmlTitle,visible:e.xmlOpen,width:"60%","append-to-body":""},on:{"update:visible":function(t){e.xmlOpen=t}}},[t("div",{directives:[{name:"highlight",rawName:"v-highlight"}]},[t("pre",[e._v("         "),t("code",{staticClass:"xml"},[e._v("\n            "+e._s(e.xmlContent)+"\n         ")]),e._v("\n      ")])])]):e._e()],1)},i=[],r=(n("b0c0"),n("d3b7"),n("159b"),n("db18")),o=n("ae3a"),s=n("347e"),l=n.n(s),c=n("1487"),u=n.n(c),d=(n("9f21"),n("fef2")),m=n("ca17"),p=n.n(m),f=(n("542c"),{name:"Model",props:{forward:Function,enterParams:{type:Object,default:function(){return{}}}},components:{Treeselect:p.a,bpmnModeler:o["a"],vkbeautify:l.a},directives:{highlight:function(e){var t=e.querySelectorAll("pre code");t.forEach((function(e){u.a.highlightBlock(e)}))}},data:function(){return{xml:"",modeler:"",xmlOpen:!1,xmlTitle:"",xmlContent:"",users:[],groups:[],categorys:[]}},created:function(){if("edit"==this.enterParams.type){var e=this.enterParams.deployId;console.log("deployid:",e),this.getModelDetail(e)}this.getTenantCategoryList(),this.getDataList()},methods:{close:function(){this.forward("List")},getTenantCategoryList:function(){var e=this;Object(d["f"])().then((function(t){e.categorys=t.data.items}))},getModelDetail:function(e){var t=this;Object(r["e"])({deployId:e}).then((function(e){t.xml=e.data,t.modeler=e.data}))},save:function(e){var t=this,n={name:e.process.name,categoryId:e.process.category,xml:e.xml};Object(r["g"])(n).then((function(e){t.forward("List")}))},getDataList:function(){var e=this;Object(r["f"])({status:0}).then((function(t){t.data.items.forEach((function(e){e.roleId=e.id})),e.groups=t.data.items}))},showXML:function(e){this.xmlTitle="xml查看",this.xmlContent=l.a.xml(e),this.xmlOpen=!0},dataType:function(e){this.users=[],this.groups=[],e&&("dynamic"===e.dataType?"assignee"===e.userType?this.users=[{realName:"流程发起人",userId:"${INITIATOR}"},{realName:"申请人部门分管院长",userId:"#{DEPT_LEADER_USER_ID}"},{realName:"申请人部门领导",userId:"#{DEPT_CHARGE_MAN_USER_ID}"},{realName:"申请人部门资产管理员",userId:"#{DEPT_ASSET_MANAGER_USER_ID}"},{realName:"相对部门分管院长",userId:"#{DEST_DEPT_LEADER_USER_ID}"},{realName:"相对部门领导",userId:"#{DEST_DEPT_CHARGE_MAN_USER_ID}"},{realName:"相对部门资产管理员",userId:"#{DEST_DEPT_ASSET_MANAGER_USER_ID}"}]:"candidateUsers"===e.userType?this.users=[{realName:"#{approval}",userId:"#{approval}"}]:this.groups=[{roleName:"#{approval}",roleId:"#{approval}"}]:this.getDataList())}}}),h=f,g=n("2877"),b=Object(g["a"])(h,a,i,!1,null,null,null);t["default"]=b.exports},a0bb:function(e,t,n){},a2b0:function(e,t,n){},a36b:function(e,t,n){e.exports=n.p+"static/img/404.5f76e018.png"},a3e5:function(e,t,n){"use strict";n("a0bb")},a497:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"tabel-container"},[t("el-card",{staticClass:"mb10",attrs:{shadow:"never"}},[t("el-form",{ref:"queryForm",attrs:{inline:!0,model:e.queryParams,size:"small"},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:"流程分类名称",prop:"categoryName"}},[t("el-input",{attrs:{placeholder:"请输入流程分类名称",clearable:"",size:"small"},model:{value:e.queryParams.categoryName,callback:function(t){e.$set(e.queryParams,"categoryName",t)},expression:"queryParams.categoryName"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),t("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1)],1),t("el-card",{attrs:{shadow:"never"}},[t("div",{staticClass:"mb10 tool-rows"},[t("div"),t("el-button",{attrs:{type:"primary",plain:"",size:"mini",icon:"el-icon-plus"},on:{click:function(t){return e.handleAdd()}}},[e._v(" 新增 ")])],1),e.refreshTable?t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.treeTable,"row-key":"id","default-expand-all":e.isExpandAll,"tree-props":{children:"children",hasChildren:"hasChildren"}}},[t("el-table-column",{attrs:{prop:"categoryName",label:"流程分类名称"}}),t("el-table-column",{attrs:{prop:"categoryCode",label:"流程分类编码"}}),t("el-table-column",{attrs:{prop:"orderBy",label:"排序",width:"130"}}),t("el-table-column",{attrs:{prop:"status",label:"状态",formatter:e.statusFormat,width:"150"}}),t("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(n){return[e.$_has(e.editCode)?t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleUpdate(n.row)}}},[e._v("修改")]):e._e(),e.$_has(e.addCode)?t("div",{staticClass:"el-divider el-divider--vertical",attrs:{direction:"vertical"}}):e._e(),e.$_has(e.addCode)?t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleAdd(n.row.id)}}},[e._v(" 新增 ")]):e._e(),e.$_has(e.delCode)?t("div",{staticClass:"el-divider el-divider--vertical",attrs:{direction:"vertical"}}):e._e(),e.$_has(e.delCode)?t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.handleDelete(n.row)}}},[e._v("删除")]):e._e()]}}],null,!1,3468775662)})],1):e._e()],1),t("el-dialog",{attrs:{title:e.title,visible:e.open,width:"800px","append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.open=t}}},[t("el-card",[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"110px"}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"上级分类",prop:"parentId"}},[t("treeselect",{attrs:{options:e.categoryOptions,normalizer:e.normalizer,"show-count":!0,placeholder:"选择上级分类"},model:{value:e.form.parentId,callback:function(t){e.$set(e.form,"parentId",t)},expression:"form.parentId"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"分类名称",prop:"categoryName"}},[t("el-input",{attrs:{placeholder:"请输入流程分类名称"},model:{value:e.form.categoryName,callback:function(t){e.$set(e.form,"categoryName",t)},expression:"form.categoryName"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"分类编码",prop:"categoryCode"}},[t("el-input",{attrs:{placeholder:"请输入流程分类编码"},model:{value:e.form.categoryCode,callback:function(t){e.$set(e.form,"categoryCode",t)},expression:"form.categoryCode"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"分类小图标"}},[t("el-popover",{attrs:{placement:"bottom-start",width:"460",trigger:"click"},on:{show:function(t){return e.$refs["iconSelect"].reset()}}},[t("IconSelect",{ref:"iconSelect",on:{selected:e.selected}}),t("el-input",{attrs:{slot:"reference",placeholder:"点击选择图标",readonly:""},slot:"reference",model:{value:e.form.minIcon,callback:function(t){e.$set(e.form,"minIcon",t)},expression:"form.minIcon"}},[e.form.minIcon?t("svg-icon",{staticClass:"el-input__icon",staticStyle:{height:"32px",width:"16px"},attrs:{slot:"prefix","icon-class":e.form.minIcon},slot:"prefix"}):t("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"prefix"},slot:"prefix"})],1)],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"分类状态"}},[t("el-radio-group",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},e._l(e.statusOptions,(function(n){return t("el-radio",{key:n.value,attrs:{label:n.value}},[e._v(e._s(n.label)+" ")])})),1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"显示排序",prop:"orderBy"}},[t("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.form.orderBy,callback:function(t){e.$set(e.form,"orderBy",t)},expression:"form.orderBy"}})],1)],1)],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),t("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},i=[],r=n("5530"),o=n("c7eb"),s=n("1da1"),l=(n("caad"),n("2532"),n("fef2")),c=n("ca17"),u=n.n(c),d=(n("542c"),n("5aee")),m={name:"FlowCategory",components:{IconSelect:d["a"],Treeselect:u.a},data:function(){return{addCode:["adm:flw:category:add"],editCode:["adm:flw:category:edit"],delCode:["adm:flw:category:del"],filePicList:[],activeOrg:"0",loading:!1,categoryList:[],categoryOptions:[],isExpandAll:!0,refreshTable:!0,title:"",open:!1,visibleOptions:[],statusOptions:[{label:"正常",value:0},{label:"禁用",value:1}],queryParams:{categoryName:void 0},form:{},rules:{categoryName:[{required:!0,message:"流程分类名称不能为空",trigger:"blur"}],orderBy:[{required:!0,message:"流程分类顺序不能为空",trigger:"blur"}],path:[{required:!0,message:"路由地址不能为空",trigger:"blur"}]}}},computed:{treeTable:function(){var e=this.queryParams.categoryName;if(e){var t=this.categoryList,n=this.handleTreeData(t,e);return n}return this.categoryList}},created:function(){var e=this;return Object(s["a"])(Object(o["a"])().mark((function t(){return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getList();case 2:case"end":return t.stop()}}),t)})))()},methods:{handleTreeData:function(e,t){if(!e||0===e.length)return[];for(var n=[],a=0;a<e.length;a+=1){var i=e[a]["categoryName"].includes(t);(this.handleTreeData(e[a].children,t).length>0||i)&&(0==e[a].type&&i?(this.flag=0,t="",n.push(Object(r["a"])(Object(r["a"])({},e[a]),{},{children:this.handleTreeData(e[a].children,t)}))):1==e[a].type&&i?(0==this.flag&&(this.flag=1),t="",n.push(Object(r["a"])(Object(r["a"])({},e[a]),{},{children:this.handleTreeData(e[a].children,t)})),1!=this.flag&&(t=this.queryParams.categoryName)):n.push(Object(r["a"])(Object(r["a"])({},e[a]),{},{children:this.handleTreeData(e[a].children,t)})))}return n},statusFormat:function(e,t){return 0==e.status?"正常":"禁用"},toggleExpandAll:function(){var e=this;this.refreshTable=!1,this.isExpandAll=!this.isExpandAll,this.$nextTick((function(){e.refreshTable=!0}))},normalizer:function(e){return e.children&&!e.children.length&&delete e.children,{id:e.id,label:e.categoryName,children:e.children}},selected:function(e){this.form.minIcon=e},getList:function(){var e=this;this.loading=!0,Object(l["f"])(this.queryParams).then((function(t){e.categoryList=t.data.items,e.loading=!1})).catch((function(t){e.loading=!1}))},getTreeselect:function(){var e=this;Object(l["f"])().then((function(t){e.categoryOptions=[];var n={id:"0",categoryName:"主类目",children:[]};n.children=t.data.items,e.categoryOptions.push(n)}))},cancel:function(){this.open=!1,this.reset()},reset:function(){this.form={id:void 0,categoryName:void 0,parentId:"0",categoryCode:void 0,minIcon:void 0,maxIcon:void 0,orderBy:1,status:0},this.resetForm("form")},handleQuery:function(){this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleAdd:function(e){this.getTreeselect(),this.reset(),this.form.parentId=e||"0",this.open=!0,this.title="添加流程分类"},handleFileView:function(){var e=this.$router.resolve({path:"/wordview",query:{fileId:"1453579605347663872"}});window.open(e.href,"_blank")},handleUpdate:function(e){var t=this;return Object(s["a"])(Object(o["a"])().mark((function n(){return Object(o["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.getTreeselect();case 2:t.reset(),Object(l["e"])({id:e.id}).then((function(e){t.form=e.data,t.open=!0,t.title="修改流程分类"}));case 4:case"end":return n.stop()}}),n)})))()},submitForm:function(){var e=this;this.$refs["form"].validate((function(t){t&&(void 0!=e.form.id?Object(l["c"])(e.form).then((function(t){e.$message.success("修改成功"),e.open=!1,e.getList()})):Object(l["a"])(e.form).then((function(t){e.$message.success("新增成功"),e.open=!1,e.getList()})))}))},handleDelete:function(e){var t=this;this.$confirm('是否确认删除名称为"'+e.categoryName+'"的数据项?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(l["b"])({id:e.id})})).then((function(){t.getList(),t.$message.success("删除成功")}))}}},p=m,f=n("2877"),h=Object(f["a"])(p,a,i,!1,null,"2ff39055",null);t["default"]=h.exports},ab42:function(e,t,n){},ac01:function(e,t,n){"use strict";n("8f0e")},ae3a:function(e,t,n){"use strict";n("b0c0");var a=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isView,expression:"isView"}],staticClass:"flow-containers",class:{"view-mode":e.isView}},[t("el-container",{staticStyle:{height:"100%"}},[t("el-header",{staticStyle:{"border-bottom":"1px solid rgb(218 218 218)",height:"auto"}},[t("div",{staticStyle:{display:"flex",padding:"10px 0px","justify-content":"space-between"}},[t("div",[t("el-upload",{staticStyle:{"margin-right":"10px",display:"inline-block"},attrs:{action:"","before-upload":e.openBpmn}},[t("el-tooltip",{attrs:{effect:"dark",content:"加载xml",placement:"bottom"}},[t("el-button",{attrs:{size:"mini",icon:"el-icon-folder-opened"}})],1)],1),t("el-tooltip",{attrs:{effect:"dark",content:"新建",placement:"bottom"}},[t("el-button",{attrs:{size:"mini",icon:"el-icon-circle-plus"},on:{click:e.newDiagram}})],1),t("el-tooltip",{attrs:{effect:"dark",content:"自适应屏幕",placement:"bottom"}},[t("el-button",{attrs:{size:"mini",icon:"el-icon-rank"},on:{click:e.fitViewport}})],1),t("el-tooltip",{attrs:{effect:"dark",content:"放大",placement:"bottom"}},[t("el-button",{attrs:{size:"mini",icon:"el-icon-zoom-in"},on:{click:function(t){return e.zoomViewport(!0)}}})],1),t("el-tooltip",{attrs:{effect:"dark",content:"缩小",placement:"bottom"}},[t("el-button",{attrs:{size:"mini",icon:"el-icon-zoom-out"},on:{click:function(t){return e.zoomViewport(!1)}}})],1),t("el-tooltip",{attrs:{effect:"dark",content:"后退",placement:"bottom"}},[t("el-button",{attrs:{size:"mini",icon:"el-icon-back"},on:{click:function(t){e.modeler.get("commandStack").undo()}}})],1),t("el-tooltip",{attrs:{effect:"dark",content:"前进",placement:"bottom"}},[t("el-button",{attrs:{size:"mini",icon:"el-icon-right"},on:{click:function(t){e.modeler.get("commandStack").redo()}}})],1)],1),t("div",[t("el-button",{attrs:{size:"mini",icon:"el-icon-back"},on:{click:function(t){return e.hide()}}},[e._v("返回")]),t("el-button",{attrs:{size:"mini",icon:"el-icon-view"},on:{click:e.showXML}},[e._v("查看xml")]),t("el-button",{attrs:{size:"mini",icon:"el-icon-download"},on:{click:function(t){return e.saveXML(!0)}}},[e._v("下载xml")]),t("el-button",{attrs:{size:"mini",icon:"el-icon-picture"},on:{click:function(t){return e.saveImg("svg",!0)}}},[e._v("下载svg")]),t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.save}},[e._v("保存模型")])],1)])]),t("el-container",{staticStyle:{"align-items":"stretch"}},[t("el-main",{staticStyle:{padding:"0"}},[t("div",{ref:"canvas",staticClass:"canvas"})]),t("el-aside",{staticStyle:{width:"400px","min-height":"650px","background-color":"#f0f2f5",padding:"0 0"}},[e.modeler?t("panel",{attrs:{modeler:e.modeler,users:e.users,groups:e.groups,categorys:e.categorys},on:{dataType:e.dataType}}):e._e()],1)],1)],1)],1)},i=[],r=n("c7eb"),o=n("1da1"),s=(n("7db0"),n("d3b7"),n("ac1f"),n("3ca3"),n("5319"),n("159b"),n("ddb0"),n("2b3d"),n("9861"),{"Activate the global connect tool":"激活全局连接工具","Append {type}":"添加 {type}","Add Lane above":"在上面添加道","Divide into two Lanes":"分割成两个道","Divide into three Lanes":"分割成三个道","Add Lane below":"在下面添加道","Append compensation activity":"追加补偿活动","Change type":"修改类型","Connect using Association":"使用关联连接","Connect using Sequence/MessageFlow or Association":"使用顺序/消息流或者关联连接","Connect using DataInputAssociation":"使用数据输入关联连接",Remove:"移除","Activate the hand tool":"激活抓手工具","Activate the lasso tool":"激活套索工具","Activate the create/remove space tool":"激活创建/删除空间工具","Create expanded SubProcess":"创建扩展子过程","Create IntermediateThrowEvent/BoundaryEvent":"创建中间抛出事件/边界事件","Create Pool/Participant":"创建池/参与者","Parallel Multi Instance":"并行多重事件","Sequential Multi Instance":"时序多重事件",DataObjectReference:"数据对象参考",DataStoreReference:"数据存储参考",Loop:"循环","Ad-hoc":"即席","Create {type}":"创建 {type}",Task:"任务","Send Task":"发送任务","Receive Task":"接收任务","User Task":"用户任务","Manual Task":"手工任务","Business Rule Task":"业务规则任务","Service Task":"服务任务","Script Task":"脚本任务","Call Activity":"调用活动","Sub Process (collapsed)":"子流程（折叠的）","Sub Process (expanded)":"子流程（展开的）","Start Event":"开始事件",StartEvent:"开始事件","Intermediate Throw Event":"中间事件","End Event":"结束事件",EndEvent:"结束事件","Create Gateway":"创建网关","Create Intermediate/Boundary Event":"创建中间/边界事件","Message Start Event":"消息开始事件","Timer Start Event":"定时开始事件","Conditional Start Event":"条件开始事件","Signal Start Event":"信号开始事件","Error Start Event":"错误开始事件","Escalation Start Event":"升级开始事件","Compensation Start Event":"补偿开始事件","Message Start Event (non-interrupting)":"消息开始事件（非中断）","Timer Start Event (non-interrupting)":"定时开始事件（非中断）","Conditional Start Event (non-interrupting)":"条件开始事件（非中断）","Signal Start Event (non-interrupting)":"信号开始事件（非中断）","Escalation Start Event (non-interrupting)":"升级开始事件（非中断）","Message Intermediate Catch Event":"消息中间捕获事件","Message Intermediate Throw Event":"消息中间抛出事件","Timer Intermediate Catch Event":"定时中间捕获事件","Escalation Intermediate Throw Event":"升级中间抛出事件","Conditional Intermediate Catch Event":"条件中间捕获事件","Link Intermediate Catch Event":"链接中间捕获事件","Link Intermediate Throw Event":"链接中间抛出事件","Compensation Intermediate Throw Event":"补偿中间抛出事件","Signal Intermediate Catch Event":"信号中间捕获事件","Signal Intermediate Throw Event":"信号中间抛出事件","Message End Event":"消息结束事件","Escalation End Event":"定时结束事件","Error End Event":"错误结束事件","Cancel End Event":"取消结束事件","Compensation End Event":"补偿结束事件","Signal End Event":"信号结束事件","Terminate End Event":"终止结束事件","Message Boundary Event":"消息边界事件","Message Boundary Event (non-interrupting)":"消息边界事件（非中断）","Timer Boundary Event":"定时边界事件","Timer Boundary Event (non-interrupting)":"定时边界事件（非中断）","Escalation Boundary Event":"升级边界事件","Escalation Boundary Event (non-interrupting)":"升级边界事件（非中断）","Conditional Boundary Event":"条件边界事件","Conditional Boundary Event (non-interrupting)":"条件边界事件（非中断）","Error Boundary Event":"错误边界事件","Cancel Boundary Event":"取消边界事件","Signal Boundary Event":"信号边界事件","Signal Boundary Event (non-interrupting)":"信号边界事件（非中断）","Compensation Boundary Event":"补偿边界事件","Exclusive Gateway":"互斥网关","Parallel Gateway":"并行网关","Inclusive Gateway":"相容网关","Complex Gateway":"复杂网关","Event based Gateway":"事件网关",Transaction:"转运","Sub Process":"子流程","Event Sub Process":"事件子流程","Collapsed Pool":"折叠池","Expanded Pool":"展开池","no parent for {element} in {parent}":"在{parent}里，{element}没有父类","no shape type specified":"没有指定的形状类型","flow elements must be children of pools/participants":"流元素必须是池/参与者的子类","out of bounds release":"out of bounds release","more than {count} child lanes":"子道大于{count} ","element required":"元素不能为空","diagram not part of bpmn:Definitions":"流程图不符合bpmn规范","no diagram to display":"没有可展示的流程图","no process or collaboration to display":"没有可展示的流程/协作","element {element} referenced by {referenced}#{property} not yet drawn":"由{referenced}#{property}引用的{element}元素仍未绘制","already rendered {element}":"{element} 已被渲染","failed to import {element}":"导入{element}失败",Id:"标识",Name:"名称",General:"常规",Details:"详情","Message Name":"消息名称",Message:"消息",Initiator:"创建者","Asynchronous Continuations":"持续异步","Asynchronous Before":"异步前","Asynchronous After":"异步后","Job Configuration":"工作配置",Exclusive:"排除","Job Priority":"工作优先级","Retry Time Cycle":"重试时间周期",Documentation:"文档","Element Documentation":"元素文档","History Configuration":"历史配置","History Time To Live":"历史的生存时间",Forms:"表单","Form Key":"表单key","Form Fields":"表单字段","Business Key":"业务key","Form Field":"表单字段",ID:"编号",Type:"类型",Label:"名称","Default Value":"默认值",Validation:"校验","Add Constraint":"添加约束",Config:"配置",Properties:"属性","Add Property":"添加属性",Value:"值",Listeners:"监听器","Execution Listener":"执行监听","Event Type":"事件类型","Listener Type":"监听器类型","Java Class":"Java类",Expression:"表达式","Must provide a value":"必须提供一个值","Delegate Expression":"代理表达式",Script:"脚本","Script Format":"脚本格式","Script Type":"脚本类型","Inline Script":"内联脚本","External Script":"外部脚本",Resource:"资源","Field Injection":"字段注入",Extensions:"扩展","Input/Output":"输入/输出","Input Parameters":"输入参数","Output Parameters":"输出参数",Parameters:"参数","Output Parameter":"输出参数","Timer Definition Type":"定时器定义类型","Timer Definition":"定时器定义",Date:"日期",Duration:"持续",Cycle:"循环",Signal:"信号","Signal Name":"信号名称",Escalation:"升级",Error:"错误","Link Name":"链接名称",Condition:"条件名称","Variable Name":"变量名称","Variable Event":"变量事件","Specify more than one variable change event as a comma separated list.":"多个变量事件以逗号隔开","Wait for Completion":"等待完成","Activity Ref":"活动参考","Version Tag":"版本标签",Executable:"可执行文件","External Task Configuration":"扩展任务配置","Task Priority":"任务优先级",External:"外部",Connector:"连接器","Must configure Connector":"必须配置连接器","Connector Id":"连接器编号",Implementation:"实现方式","Field Injections":"字段注入",Fields:"字段","Result Variable":"结果变量",Topic:"主题","Configure Connector":"配置连接器","Input Parameter":"输入参数",Assignee:"代理人","Candidate Users":"候选用户","Candidate Groups":"候选组","Due Date":"到期时间","Follow Up Date":"跟踪日期",Priority:"优先级","The follow up date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)":"跟踪日期必须符合EL表达式，如： ${someDate} ,或者一个ISO标准日期，如：2015-06-26T09:54:00","The due date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)":"跟踪日期必须符合EL表达式，如： ${someDate} ,或者一个ISO标准日期，如：2015-06-26T09:54:00",Variables:"变量"}),l={"bpmn:Process":"流程","bpmn:StartEvent":"开始事件","bpmn:IntermediateThrowEvent":"中间事件","bpmn:Task":"任务","bpmn:SendTask":"发送任务","bpmn:ReceiveTask":"接收任务","bpmn:UserTask":"用户任务","bpmn:ManualTask":"手工任务","bpmn:BusinessRuleTask":"业务规则任务","bpmn:ServiceTask":"服务任务","bpmn:ScriptTask":"脚本任务","bpmn:EndEvent":"结束事件","bpmn:SequenceFlow":"流程线","bpmn:ExclusiveGateway":"互斥网关","bpmn:ParallelGateway":"并行网关","bpmn:InclusiveGateway":"相容网关","bpmn:ComplexGateway":"复杂网关","bpmn:EventBasedGateway":"事件网关"};function c(e,t){return t=t||{},e=s[e]||e,e.replace(/{([^}]+)}/g,(function(e,n){var a=t[n];return null!==s[t[n]]&&"undefined"!==s[t[n]]&&(a=s[t[n]]),a||"{"+n+"}"}))}var u=n("7024"),d=function(){var e=this,t=e._self._c;return t("div",{ref:"propertyPanel",staticClass:"property-panel"},[e.nodeName?t("div",{staticClass:"node-name"},[e._v(e._s(e.nodeName))]):e._e(),e.element?t(e.getComponent,{tag:"component",attrs:{element:e.element,modeler:e.modeler,users:e.users,groups:e.groups,categorys:e.categorys},on:{dataType:e.dataType}}):e._e()],1)},m=[],p=(n("caad"),function(){var e=this,t=e._self._c;return t("div",[t("x-form",{ref:"xForm",attrs:{config:e.formConfig},scopedSlots:e._u([{key:"executionListener",fn:function(){return[t("el-badge",{attrs:{value:e.executionListenerLength}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogName="executionListenerDialog"}}},[e._v("编辑")])],1)]},proxy:!0},{key:"taskListener",fn:function(){return[t("el-badge",{attrs:{value:e.taskListenerLength}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogName="taskListenerDialog"}}},[e._v("编辑")])],1)]},proxy:!0},{key:"multiInstance",fn:function(){return[t("el-badge",{attrs:{"is-dot":e.hasMultiInstance}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogName="multiInstanceDialog"}}},[e._v("编辑")])],1)]},proxy:!0},{key:"assignee",fn:function(){return[e._l(e.checkedUserData,(function(n){return t("el-tag",{key:n.userId,staticStyle:{"margin-right":"10px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(t){return e.handleRemoveUser(n)}}},[e._v(e._s(n.realName))])})),t("el-button",{attrs:{size:"small"},on:{click:e.onUserSelect}},[e._v("选择人员")])]},proxy:!0},{key:"candidateUsers",fn:function(){return[e._l(e.checkedUserData,(function(n){return t("el-tag",{key:n.userId,staticStyle:{"margin-right":"10px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(t){return e.handleRemoveUser(n)}}},[e._v(e._s(n.realName))])})),t("el-button",{attrs:{size:"small"},on:{click:e.onUserSelect}},[e._v("选择人员")])]},proxy:!0}]),model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}}),"executionListenerDialog"===e.dialogName?t("executionListenerDialog",{attrs:{element:e.element,modeler:e.modeler},on:{close:e.finishExecutionListener}}):e._e(),"taskListenerDialog"===e.dialogName?t("taskListenerDialog",{attrs:{element:e.element,modeler:e.modeler},on:{close:e.finishTaskListener}}):e._e(),"multiInstanceDialog"===e.dialogName?t("multiInstanceDialog",{attrs:{element:e.element,modeler:e.modeler},on:{close:e.finishMultiInstance}}):e._e(),t("SelectUserTable",{attrs:{enterParam:{mode:e.userMode}},on:{getUserData:e.handleSelectUser},model:{value:e.userDialogVisible,callback:function(t){e.userDialogVisible=t},expression:"userDialogVisible"}})],1)}),f=[],h=(n("4de4"),n("c740"),n("a15b"),n("d81d"),n("a434"),n("e9c4"),n("b64b"),n("2532"),n("9b3c")),g=n.n(h),b=n("a8b6"),y={"bpmn:EndEvent":{},"bpmn:StartEvent":{initiator:!0,formKey:!0},"bpmn:UserTask":{userType:!0,dataType:!0,assignee:!0,candidateUsers:!0,candidateGroups:!0,formKey:!0,skipExpression:!0,taskListener:!0},"bpmn:ServiceTask":{async:!0,skipExpression:!0,isForCompensation:!0,triggerable:!0,class:!0},"bpmn:ScriptTask":{async:!0,isForCompensation:!0,autoStoreVariables:!0},"bpmn:ManualTask":{async:!0,isForCompensation:!0},"bpmn:ReceiveTask":{async:!0,isForCompensation:!0},"bpmn:SendTask":{async:!0,isForCompensation:!0},"bpmn:BusinessRuleTask":{async:!0,isForCompensation:!0,ruleVariablesInput:!0,rules:!0,resultVariable:!0,exclude:!0}};b["a"].set({input:{},select:{},colorPicker:{showAlpha:!0},xform:{form:{labelWidth:"auto"}}});var v={components:{xForm:g.a.xForm},props:{modeler:{type:Object,required:!0},element:{type:Object,required:!0},categorys:{type:Array,default:function(){return[]}}},watch:{"formData.id":function(e){this.updateProperties({id:e})},"formData.name":function(e){this.updateProperties({name:e})},"formData.documentation":function(e){if(e){var t=this.modeler.get("moddle").create("bpmn:Documentation",{text:e});this.updateProperties({documentation:[t]})}else this.updateProperties({documentation:[]})}},methods:{updateProperties:function(e){var t=this.modeler.get("modeling");t.updateProperties(this.element,e)}},computed:{elementType:function(){var e=this.element.businessObject;return e.eventDefinitions?e.eventDefinitions[0].$type:e.$type},showConfig:function(){return y[this.elementType]||{}}}},w=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:"执行监听器",visible:e.dialogVisible,width:"900px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t},closed:function(t){return e.$emit("close")}}},[t("x-form",{ref:"xForm",attrs:{config:e.formConfig},scopedSlots:e._u([{key:"params",fn:function(n){return[t("el-badge",{attrs:{value:n.row.params?n.row.params.length:0,type:"primary"}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.configParam(n.$index)}}},[e._v("配置")])],1)]}}]),model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.closeDialog}},[e._v("确 定")])],1)],1),e.showParamDialog?t("listenerParam",{attrs:{value:e.formData.executionListener[e.nowIndex].params},on:{close:e.finishConfigParam}}):e._e()],1)},x=[],k=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:"监听器参数",visible:e.dialogVisible,width:"700px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t},closed:function(t){return e.$emit("close",e.formData.paramList)}}},[t("x-form",{ref:"xForm",attrs:{config:e.formConfig},model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.closeDialog}},[e._v("确 定")])],1)],1)],1)},C=[];b["a"].set({input:{},select:{},colorPicker:{showAlpha:!0},xform:{form:{labelWidth:"auto"}}});var D={components:{xForm:g.a.xForm}},S={mixins:[D],props:{value:{type:Array,default:function(){return[]}}},data:function(){return{dialogVisible:!0,formData:{paramList:this.value}}},computed:{formConfig:function(){return{inline:!1,item:[{xType:"tabs",tabs:[{label:"监听器参数",name:"paramList",column:[{label:"类型",name:"type",width:180,rules:[{required:!0,message:"请选择",trigger:["blur","change"]}],xType:"select",dic:[{label:"字符串",value:"stringValue"},{label:"表达式",value:"expression"}]},{label:"名称",name:"name",width:180,rules:[{required:!0,message:"请选择",trigger:["blur","change"]}],xType:"input"},{label:"值",name:"value",xType:"input",rules:[{required:!0,message:"请输入",trigger:["blur","change"]}]}]}]}]}}},methods:{closeDialog:function(){var e=this;this.$refs.xForm.validate().then((function(){e.dialogVisible=!1})).catch((function(e){return console.error(e)}))}}},T=S,E=(n("934c"),n("2877")),L=Object(E["a"])(T,k,C,!1,null,null,null),I=L.exports,_={components:{listenerParam:I},mixins:[v],data:function(){return{dialogVisible:!0,showParamDialog:!1,nowIndex:null,formData:{executionListener:[]}}},computed:{formConfig:function(){return{inline:!1,item:[{xType:"tabs",tabs:[{label:"执行监听器",name:"executionListener",column:[{label:"事件",name:"event",width:180,rules:[{required:!0,message:"请选择",trigger:["blur","change"]}],xType:"select",dic:[{label:"start",value:"start"},{label:"end",value:"end"},{label:"take",value:"take"}]},{label:"类型",name:"type",width:180,rules:[{required:!0,message:"请选择",trigger:["blur","change"]}],xType:"select",dic:[{label:"类",value:"class"},{label:"表达式",value:"expression"},{label:"委托表达式",value:"delegateExpression"}],tooltip:"类：示例 com.company.MyCustomListener，自定义类必须实现 org.flowable.engine.delegate.TaskListener 接口 <br />\n                              表达式：示例 ${myObject.callMethod(task, task.eventName)} <br />\n                              委托表达式：示例 ${myListenerSpringBean} ，该 springBean 需要实现 org.flowable.engine.delegate.TaskListener 接口\n                    "},{label:"java 类名",name:"className",xType:"input",rules:[{required:!0,message:"请输入",trigger:["blur","change"]}]},{xType:"slot",label:"参数",width:120,slot:!0,name:"params"}]}]}]}}},mounted:function(){var e,t;this.formData.executionListener=null!==(e=null===(t=this.element.businessObject.extensionElements)||void 0===t?void 0:t.values.filter((function(e){return"flowable:ExecutionListener"===e.$type})).map((function(e){var t,n,a;return"class"in e&&(a="class"),"expression"in e&&(a="expression"),"delegateExpression"in e&&(a="delegateExpression"),{event:e.event,type:a,className:e[a],params:null!==(t=null===(n=e.fields)||void 0===n?void 0:n.map((function(e){var t;return"stringValue"in e&&(t="stringValue"),"expression"in e&&(t="expression"),{name:e.name,type:t,value:e[t]}})))&&void 0!==t?t:[]}})))&&void 0!==e?e:[]},methods:{configParam:function(e){this.nowIndex=e;var t=this.formData.executionListener[e];t.params||(t.params=[]),this.showParamDialog=!0},finishConfigParam:function(e){this.showParamDialog=!1;var t=this.formData.executionListener[this.nowIndex];t.params=e,this.$set(this.formData.executionListener[this.nowIndex],this.nowIndex,t),this.nowIndex=null},updateElement:function(){var e,t=this;if(null!==(e=this.formData.executionListener)&&void 0!==e&&e.length){var n,a,i=this.element.businessObject.get("extensionElements");i||(i=this.modeler.get("moddle").create("bpmn:ExtensionElements")),i.values=null!==(n=null===(a=i.values)||void 0===a?void 0:a.filter((function(e){return"flowable:ExecutionListener"!==e.$type})))&&void 0!==n?n:[],this.formData.executionListener.forEach((function(e){var n=t.modeler.get("moddle").create("flowable:ExecutionListener");n["event"]=e.event,n[e.type]=e.className,e.params&&e.params.length&&e.params.forEach((function(e){var a=t.modeler.get("moddle").create("flowable:Field");a["name"]=e.name,a[e.type]=e.value,n.get("fields").push(a)})),i.get("values").push(n)})),this.updateProperties({extensionElements:i})}else{var r,o,s=this.element.businessObject["extensionElements"];if(s)s.values=null!==(r=null===(o=s.values)||void 0===o?void 0:o.filter((function(e){return"flowable:ExecutionListener"!==e.$type})))&&void 0!==r?r:[]}},closeDialog:function(){var e=this;this.$refs.xForm.validate().then((function(){e.updateElement(),e.dialogVisible=!1})).catch((function(e){return console.error(e)}))}}},O=_,P=(n("0b11"),Object(E["a"])(O,w,x,!1,null,null,null)),A=P.exports,N=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:"任务监听器",visible:e.dialogVisible,width:"900px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t},closed:function(t){return e.$emit("close")}}},[t("x-form",{ref:"xForm",attrs:{config:e.formConfig},scopedSlots:e._u([{key:"params",fn:function(n){return[t("el-badge",{attrs:{value:n.row.params?n.row.params.length:0,type:"primary"}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.configParam(n.$index)}}},[e._v("配置")])],1)]}}]),model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.closeDialog}},[e._v("确 定")])],1)],1),e.showParamDialog?t("listenerParam",{attrs:{value:e.formData.taskListener[e.nowIndex].params},on:{close:e.finishConfigParam}}):e._e()],1)},j=[],M={components:{listenerParam:I},mixins:[v],data:function(){return{dialogVisible:!0,showParamDialog:!1,nowIndex:null,formData:{taskListener:[]}}},computed:{formConfig:function(){return{inline:!1,item:[{xType:"tabs",tabs:[{label:"任务监听器",name:"taskListener",column:[{label:"事件",name:"event",width:180,rules:[{required:!0,message:"请选择",trigger:["blur","change"]}],xType:"select",dic:[{label:"create",value:"create"},{label:"assignment",value:"assignment"},{label:"complete",value:"complete"},{label:"delete",value:"delete"}],tooltip:"create（创建）：当任务已经创建，并且所有任务参数都已经设置时触发。<br />\n                              assignment（指派）：当任务已经指派给某人时触发。请注意：当流程执行到达用户任务时，在触发create事件之前，会首先触发assignment事件。<br />\n                              complete（完成）：当任务已经完成，从运行时数据中删除前触发。<br />\n                              delete（删除）：在任务即将被删除前触发。请注意任务由completeTask正常完成时也会触发。\n                    "},{label:"类型",name:"type",width:180,rules:[{required:!0,message:"请选择",trigger:["blur","change"]}],xType:"select",dic:[{label:"类",value:"class"},{label:"表达式",value:"expression"},{label:"委托表达式",value:"delegateExpression"}]},{label:"java 类名",name:"className",xType:"input",rules:[{required:!0,message:"请输入",trigger:["blur","change"]}]},{xType:"slot",label:"参数",width:120,slot:!0,name:"params"}]}]}]}}},mounted:function(){var e,t;this.formData.taskListener=null!==(e=null===(t=this.element.businessObject.extensionElements)||void 0===t?void 0:t.values.filter((function(e){return"flowable:TaskListener"===e.$type})).map((function(e){var t,n,a;return"class"in e&&(a="class"),"expression"in e&&(a="expression"),"delegateExpression"in e&&(a="delegateExpression"),{event:e.event,type:a,className:e[a],params:null!==(t=null===(n=e.fields)||void 0===n?void 0:n.map((function(e){var t;return"stringValue"in e&&(t="stringValue"),"expression"in e&&(t="expression"),{name:e.name,type:t,value:e[t]}})))&&void 0!==t?t:[]}})))&&void 0!==e?e:[]},methods:{configParam:function(e){this.nowIndex=e;var t=this.formData.taskListener[e];t.params||(t.params=[]),this.showParamDialog=!0},finishConfigParam:function(e){this.showParamDialog=!1;var t=this.formData.taskListener[this.nowIndex];t.params=e,this.$set(this.formData.taskListener[this.nowIndex],this.nowIndex,t),this.nowIndex=null},updateElement:function(){var e,t=this;if(null!==(e=this.formData.taskListener)&&void 0!==e&&e.length){var n,a,i=this.element.businessObject.get("extensionElements");i||(i=this.modeler.get("moddle").create("bpmn:ExtensionElements")),i.values=null!==(n=null===(a=i.values)||void 0===a?void 0:a.filter((function(e){return"flowable:TaskListener"!==e.$type})))&&void 0!==n?n:[],this.formData.taskListener.forEach((function(e){var n=t.modeler.get("moddle").create("flowable:TaskListener");n["event"]=e.event,n[e.type]=e.className,e.params&&e.params.length&&e.params.forEach((function(e){var a=t.modeler.get("moddle").create("flowable:Field");a["name"]=e.name,a[e.type]=e.value,n.get("fields").push(a)})),i.get("values").push(n)})),this.updateProperties({extensionElements:i})}else{var r,o,s=this.element.businessObject["extensionElements"];if(s)s.values=null!==(r=null===(o=s.values)||void 0===o?void 0:o.filter((function(e){return"flowable:TaskListener"!==e.$type})))&&void 0!==r?r:[]}},closeDialog:function(){var e=this;this.$refs.xForm.validate().then((function(){e.updateElement(),e.dialogVisible=!1})).catch((function(e){return console.error(e)}))}}},z=M,F=(n("c0fc"),Object(E["a"])(z,N,j,!1,null,null,null)),U=F.exports,B=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{staticClass:"muti-instance",attrs:{title:"多实例配置",visible:e.dialogVisible,width:"500px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t},closed:function(t){return e.$emit("close")}}},[t("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{type:"info",closable:!1,"show-icon":""},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" 按照BPMN2.0规范的要求，用于为每个实例创建执行的父执行，会提供下列变量:"),t("br"),e._v(" nrOfInstances：实例总数。"),t("br"),e._v(" nrOfActiveInstances：当前活动的（即未完成的），实例数量。对于顺序多实例，这个值总为1。"),t("br"),e._v(" nrOfCompletedInstances：已完成的实例数量。"),t("br"),e._v(" loopCounter：给定实例在for-each循环中的index。"),t("br")]},proxy:!0}])}),t("x-form",{ref:"xForm",attrs:{config:e.formConfig},model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}})],1)],1)},$=[],q=n("5530");function R(e){var t=Object(q["a"])(Object(q["a"])({},e.businessObject),e.businessObject.$attrs);return V(t)}function V(e){for(var t in e)if(0===t.indexOf("flowable:")){var n=t.replace("flowable:","");e[n]=e[t],delete e[t]}return e=G(e),e}function G(e){if("documentation"in e){var t="";e.documentation.forEach((function(e){t+=e.text})),e.documentation=t}return e}function Q(e){return"conditionExpression"in e&&(e.conditionExpression=e.conditionExpression.body),e}function K(e){for(var t in e)if("candidateUsers"===t)e.userType="candidateUsers",e[t]=e[t];else if("candidateGroups"===t){var n;e.userType="candidateGroups",e[t]=(null===(n=e[t])||void 0===n?void 0:n.split(","))||[]}else"assignee"===t&&(e.userType="assignee",e[t]=e[t]);return e}var J={mixins:[v],data:function(){return{dialogVisible:!0,formData:{}}},computed:{formConfig:function(){var e=this;return{inline:!1,item:[{xType:"input",name:"collection",label:"集合",tooltip:"属性会作为表达式进行解析。如果表达式解析为字符串而不是一个集合，<br />不论是因为本身配置的就是静态字符串值，还是表达式计算结果为字符串，<br />这个字符串都会被当做变量名，并从流程变量中用于获取实际的集合。"},{xType:"input",name:"elementVariable",label:"元素变量",tooltip:"每创建一个用户任务前，先以该元素变量为label，集合中的一项为value，<br />创建（局部）流程变量，该局部流程变量被用于指派用户任务。<br />一般来说，该字符串应与指定人员变量相同。"},{xType:"radio",name:"isSequential",label:"执行方式",dic:[{label:"串行",value:!0},{label:"并行",value:!1}]},{xType:"input",name:"completionCondition",label:"完成条件",tooltip:"多实例活动在所有实例都完成时结束，然而也可以指定一个表达式，在每个实例<br />结束时进行计算。当表达式计算为true时，将销毁所有剩余的实例，并结束多实例<br />活动，继续执行流程。例如 ${nrOfCompletedInstances/nrOfInstances >= 0.6 }，<br />表示当任务完成60%时，该节点就算完成"}],operate:[{text:"确定",show:!0,click:e.save},{text:"清空",show:!0,click:function(){e.formData={}}}]}}},mounted:function(){var e,t,n=JSON.parse(JSON.stringify(null!==(e=this.element.businessObject.loopCharacteristics)&&void 0!==e?e:{}));n.completionCondition=null===(t=n.completionCondition)||void 0===t?void 0:t.body,this.formData=V(n)},methods:{updateElement:function(){if(null!==this.formData.isSequential&&void 0!==this.formData.isSequential){var e=this.element.businessObject.get("loopCharacteristics");if(e||(e=this.modeler.get("moddle").create("bpmn:MultiInstanceLoopCharacteristics")),e["isSequential"]=this.formData.isSequential,e["collection"]=this.formData.collection,e["elementVariable"]=this.formData.elementVariable,this.formData.completionCondition){var t=this.modeler.get("moddle").create("bpmn:Expression",{body:this.formData.completionCondition});e["completionCondition"]=t}this.updateProperties({loopCharacteristics:e})}else delete this.element.businessObject.loopCharacteristics},save:function(){this.updateElement(),this.dialogVisible=!1}}},X=J,H=(n("d314"),Object(E["a"])(X,B,$,!1,null,null,null)),Y=H.exports,W=function(){var e=this,t=e._self._c;return e.refresh?t("el-dialog",{attrs:{id:"size","append-to-body":"",title:"选择用户",visible:e.isShow,width:"1000px",top:"20px","close-on-click-modal":!1},on:{"update:visible":function(t){e.isShow=t},close:e.hide}},[t("el-card",[t("el-row",{staticStyle:{display:"flex"}},[t("el-col",{staticClass:"box-left"},[t("div",{staticClass:"scroll-left"},[t("div",{staticClass:"treeList"},[e.isShow?t("el-tree",{ref:"orgTree",attrs:{lazy:"","node-key":"id",data:e.orgList,props:e.orgTreeProps,load:e.loadOrgData,"expand-on-click-node":!1,"highlight-current":!0,"default-expand-all":!1,"default-expanded-keys":e.nodeKey},on:{"node-click":e.onOrgClick}}):e._e()],1)])]),t("el-col",{staticClass:"box-right"},[t("el-form",{ref:"queryForm",staticClass:"mb10",attrs:{inline:!0,model:e.queryParams,size:"mini"},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{prop:"keyword"}},[t("el-input",{staticClass:"inputWidth",attrs:{placeholder:"按姓名/账号/手机号搜索",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery()}},model:{value:e.queryParams.keyword,callback:function(t){e.$set(e.queryParams,"keyword",t)},expression:"queryParams.keyword"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:function(t){return e.handleQuery()}}},[e._v("搜索")]),t("el-button",{attrs:{type:"default",size:"mini"},on:{click:e.handleRefresh}},[e._v("重置")])],1)],1),t("div",{staticStyle:{background:"#fff","margin-top":"-8px"}},[t("div",{staticClass:"scroll-box"},[t("div",{staticClass:"tableContainer treeList"},[t("div",{staticClass:"body"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"selectMultipleTable",attrs:{data:e.userList,"row-key":"userId"},on:{"row-click":e.handleSingleSelected,"selection-change":e.handleMultipleSelected}},["multiple"==e.enterParam.mode?t("el-table-column",{attrs:{"reserve-selection":!0,type:"selection",width:"50",align:"center"}}):t("el-table-column",{attrs:{label:"",width:"30",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-radio",{attrs:{label:n.row.userId},model:{value:e.selectedUserId,callback:function(t){e.selectedUserId=t},expression:"selectedUserId"}},[e._v(" "+e._s()+" ")])]}}],null,!1,1585123792)}),t("el-table-column",{attrs:{prop:"userName",label:"登录账号",align:"center"}}),t("el-table-column",{attrs:{prop:"phone",label:"手机号码",align:"center"}}),t("el-table-column",{attrs:{prop:"realName",label:"真实姓名",align:"center"}}),t("el-table-column",{attrs:{prop:"sex",label:"性别",align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("span",[e._v(" "+e._s("2"==n.row.sex?"女":"男")+" ")])]}}],null,!1,656651739)})],1),t("ns-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}})],1)])])])],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.hide}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("保 存")])],1)],1):e._e()},Z=[],ee=n("b775"),te={getAllArea:"/adm-service/area/info/all",getAllEnt:"/adm-service/ent/info/all",getSubDept:"/adm-service/ent/dept/all",deptAdd:"/adm-service/ent/dept/add",deptEdit:"/adm-service/ent/dept/edit",deptDel:"/adm-service/ent/dept/del",deptGet:"/adm-service/ent/dept/get",deptTree:"/adm-service/ent/user/getDeptTrees",userList:"/adm-service/ent/user/orgUserList",userAdd:"/adm-service/ent/user/orgUserAdd",userEdit:"/adm-service/ent/user/orgUserEdit",userDel:"/adm-service/ent/user/orgUserDel",userGet:"/adm-service/ent/user/orgUserGet",userListByIds:"/adm-service/ent/user/orgUserListByIds",webRoleList:"/adm-service/ent/user/webRoleList",optRoleList:"/adm-service/ent/user/optRoleList",userImport:"/adm-service/ent/user/orgUserImp",userExport:"/adm-service/ent/user/exp"};function ne(e){return ee["a"].post(te.getAllEnt,e?Object(q["a"])(Object(q["a"])({},e),{},{propertyEntType:1}):{propertyEntType:1})}function ae(e){return ee["a"].post(te.getSubDept,e||{})}function ie(e){return ee["a"].post(te.userList,e||{})}function re(e){return ee["a"].post(te.userListByIds,e||{})}var oe={props:{value:{type:Boolean,required:!0},enterParam:{type:Object,default:function(){return{}}}},data:function(){return{loading:!1,isShow:!1,refresh:!0,queryParams:{pageNum:1,pageSize:20,areaId:"",entId:"",deptCode:"",status:"0",keyword:""},total:0,userList:[],orgTreeProps:{label:"orgName",children:"children"},orgList:[],nodeKey:[],selectedUserId:"",selectedUserList:[]}},watch:{value:function(e){var t=this;this.isShow=e,e&&(this.refresh=!0,console.log("enter param mode:",this.enterParam.mode),this.enterParam.userJson&&(this.selectedUserList=JSON.parse(this.enterParam.userJson)||[],"multiple"==this.enterParam.mode?this.$nextTick((function(){t.selectedUserList.map((function(e){t.$refs.selectMultipleTable.toggleRowSelection(Object(q["a"])(Object(q["a"])({},e),{},{realName:e.userName}),!0)}))})):setTimeout((function(){t.$nextTick((function(){t.selectedUserId=t.selectedUserList.length>0?t.selectedUserList[0].userId:""}))}),100)))},isShow:function(e){this.$emit("input",e)}},methods:{hide:function(){this.resetForm("queryForm"),this.$refs.selectMultipleTable.clearSelection(),this.selectedUserList=[],this.selectedUserId="",this.refresh=!1,this.isShow=!1},handleRefresh:function(){this.resetForm("queryForm"),this.handleQuery()},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},onOrgClick:function(e){1==e.type?(this.queryParams.entId=e.id,this.queryParams.deptCode=""):(this.queryParams.entId=e.entId,this.queryParams.deptCode=e.deptCode),this.handleQuery()},loadOrgData:function(e,t){var n=this;return Object(o["a"])(Object(r["a"])().mark((function a(){var i,o,s,l,c;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(i=n,0!=e.level){a.next=14;break}return a.next=4,ne({areaId:""});case 4:if(o=a.sent,0!=o.code){a.next=11;break}return s=o.data.items.map((function(e){return i.$set(e,"type",1),i.$set(e,"orgName",e.entName),e})),s&&s.length>0&&(n.nodeKey=[s[0].id],n.$nextTick((function(){n.$refs.orgTree.setCurrentKey(s[0].id)})),n.queryParams.entId=s[0].id,n.queryParams.deptCode="",n.handleQuery()),a.abrupt("return",t(s));case 11:return a.abrupt("return",t([]));case 12:a.next=33;break;case 14:if(1!=e.level){a.next=25;break}return a.next=17,ae({entId:e.data.id});case 17:if(l=a.sent,0!=l.code){a.next=22;break}return a.abrupt("return",t(l.data.items.map((function(e){return i.$set(e,"type",2),i.$set(e,"orgName",e.deptName),e}))));case 22:return a.abrupt("return",t([]));case 23:a.next=33;break;case 25:return a.next=27,ae({entId:e.data.entId,parentId:e.data.id});case 27:if(c=a.sent,0!=c.code){a.next=32;break}return a.abrupt("return",t(c.data.items.map((function(e){return i.$set(e,"type",2),i.$set(e,"orgName",e.deptName),e}))));case 32:return a.abrupt("return",t([]));case 33:case"end":return a.stop()}}),a)})))()},getList:function(){var e=this;this.loading=!0,ie(this.queryParams).then((function(t){e.loading=!1,0==t.code&&(e.total=t.data.total,e.userList=t.data.items)})).catch((function(){e.loading=!1}))},handleMultipleSelected:function(e){this.selectedUserList=e.map((function(e){return{userId:e.userId,userName:e.userName,realName:e.realName,phone:e.phone}}))},handleSingleSelected:function(e){this.selectedUserList=[{userId:e.userId,userName:e.userName,realName:e.realName,phone:e.phone}]},handleSubmit:function(){this.selectedUserList&&0!=this.selectedUserList.length?(this.$emit("getUserData",JSON.stringify(this.selectedUserList)),this.hide()):this.$alert("请选择用户!","提醒",{confirmButtonText:"确定"})}}},se=oe,le=(n("ac01"),Object(E["a"])(se,W,Z,!1,null,"40de755a",null)),ce=le.exports,ue={components:{executionListenerDialog:A,taskListenerDialog:U,multiInstanceDialog:Y,SelectUserTable:ce},mixins:[v],props:{users:{type:Array,required:!0},groups:{type:Array,required:!0}},data:function(){return{userMode:"single",checkedUserData:[],userTypeOption:[{label:"指定人员",value:"assignee"},{label:"候选人员",value:"candidateUsers"}],dataTypeOption:[{label:"固定",value:"fixed"},{label:"动态",value:"dynamic"},{label:"流程发起人",value:"processCreateUser"}],dialogName:"",executionListenerLength:0,taskListenerLength:0,hasMultiInstance:!1,formData:{},userDialogVisible:!1}},computed:{formConfig:function(){var e=this;return{inline:!1,labelWidth:"130px",item:[{xType:"input",name:"id",label:"节点 id",rules:[{required:!0,message:"Id 不能为空"}]},{xType:"input",name:"name",label:"节点名称",rules:[{required:!0,message:"节点名称不能为空"}]},{xType:"input",name:"documentation",label:"节点描述"},{xType:"slot",name:"executionListener",label:"执行监听器"},{xType:"slot",name:"taskListener",label:"任务监听器",show:!!e.showConfig.taskListener},{xType:"select",name:"userType",label:"人员类型",dic:e.userTypeOption,show:!!e.showConfig.userType},{xType:"select",name:"dataType",label:"指定方式",dic:e.dataTypeOption,show:!!e.showConfig.dataType,rules:[{required:!0,message:"请指定方式"}]},{xType:"slot",name:"assignee",label:"指定人员",show:!!e.showConfig.assignee&&"assignee"===e.formData.userType&&"fixed"===e.formData.dataType},{xType:"slot",name:"candidateUsers",label:"候选人员",show:!!e.showConfig.candidateUsers&&"candidateUsers"===e.formData.userType&&"fixed"===e.formData.dataType},{xType:"select",name:"assignee",label:"指定人员(表达式)",allowCreate:!0,filterable:!0,dic:{data:e.users,label:"realName",value:"userId"},show:!!e.showConfig.assignee&&"assignee"===e.formData.userType&&"dynamic"===e.formData.dataType},{xType:"select",name:"candidateUsers",label:"候选人员(表达式)",multiple:!0,allowCreate:!0,filterable:!0,dic:{data:e.users,label:"realName",value:"userId"},show:!!e.showConfig.candidateUsers&&"candidateUsers"===e.formData.userType&&"dynamic"===e.formData.dataType},{xType:"select",name:"candidateGroups",label:"候选组",multiple:!0,allowCreate:!0,filterable:!0,dic:{data:e.groups,label:"roleName",value:"roleId"},show:!!e.showConfig.candidateGroups&&"candidateGroups"===e.formData.userType},{xType:"switch",name:"async",label:"异步",activeText:"是",inactiveText:"否",show:!!e.showConfig.async},{xType:"input",name:"priority",label:"优先级",show:!!e.showConfig.priority},{xType:"input",name:"formKey",label:"表单标识key",show:!!e.showConfig.formKey},{xType:"input",name:"skipExpression",label:"跳过表达式",show:!!e.showConfig.skipExpression},{xType:"switch",name:"isForCompensation",label:"是否为补偿",activeText:"是",inactiveText:"否",show:!!e.showConfig.isForCompensation},{xType:"switch",name:"triggerable",label:"服务任务可触发",activeText:"是",inactiveText:"否",show:!!e.showConfig.triggerable},{xType:"switch",name:"autoStoreVariables",label:"自动存储变量",activeText:"是",inactiveText:"否",show:!!e.showConfig.autoStoreVariables},{xType:"input",name:"ruleVariablesInput",label:"输入变量",show:!!e.showConfig.ruleVariablesInput},{xType:"input",name:"rules",label:"规则",show:!!e.showConfig.rules},{xType:"input",name:"resultVariable",label:"结果变量",show:!!e.showConfig.resultVariable},{xType:"switch",name:"exclude",label:"排除",activeText:"是",inactiveText:"否",show:!!e.showConfig.exclude},{xType:"input",name:"class",label:"类",show:!!e.showConfig.class},{xType:"datePicker",type:"datetime",name:"dueDate",label:"到期时间",show:!!e.showConfig.dueDate}]}}},watch:{checkedUserData:function(e,t){if(!e)return delete this.element.businessObject.$attrs["flowable:assignee"],void delete this.element.businessObject.$attrs["flowable:candidateUsers"];console.log(">>>>>>>>> checked user data:",e);var n=e.map((function(e){return e.userId}));if("assignee"===this.formData.userType)return this.updateProperties({"flowable:assignee":n[0]}),void(this.formData.assignee=n[0]);"candidateUsers"===this.formData.userType&&(this.updateProperties({"flowable:candidateUsers":n.join(",")}),this.formData.candidateUsers=n.join(","))},"formData.userType":function(e,t){var n=this;if(t){this.checkedUserData=[];var a=["assignee","candidateUsers","candidateGroups"];a.forEach((function(e){delete n.element.businessObject.$attrs["flowable:".concat(e)],delete n.formData[e]}))}"assignee"===e?this.userMode="single":"candidateUsers"===e&&(this.userMode="multiple"),this.updateProperties({"flowable:userType":e})},"formData.dataType":function(e){var t=this,n=this;this.updateProperties({"flowable:dataType":e}),"dynamic"===e&&this.updateProperties({"flowable:userType":n.formData.userType});var a=["assignee","candidateUsers","candidateGroups"];a.forEach((function(e){delete t.element.businessObject.$attrs["flowable:".concat(e)],delete t.formData[e]})),"processCreateUser"===e&&this.updateProperties({"flowable:assignee":"${INITIATOR}"});var i={dataType:e,userType:this.formData.userType};this.$emit("dataType",i)},"formData.assignee":function(e){"assignee"===this.formData.userType?this.updateProperties({"flowable:assignee":e}):delete this.element.businessObject.$attrs["flowable:assignee"]},"formData.candidateUsers":function(e){"candidateUsers"===this.formData.userType?(console.log("formData.candidateUsers: ",e),this.updateProperties({"flowable:candidateUsers":e})):delete this.element.businessObject.$attrs["flowable:candidateUsers"]},"formData.candidateGroups":function(e){"candidateGroups"===this.formData.userType?this.updateProperties({"flowable:candidateGroups":null===e||void 0===e?void 0:e.join(",")}):delete this.element.businessObject.$attrs["flowable:candidateGroups"]},"formData.async":function(e){""===e&&(e=null),this.updateProperties({"flowable:async":!1})},"formData.dueDate":function(e){""===e&&(e=null),this.updateProperties({"flowable:dueDate":e})},"formData.formKey":function(e){""===e&&(e=null),this.updateProperties({"flowable:formKey":e})},"formData.priority":function(e){""===e&&(e=null),this.updateProperties({"flowable:priority":e})},"formData.skipExpression":function(e,t){void 0!==t&&(null===e&&(e=""),this.updateProperties({"flowable:skipExpression":e}))},"formData.isForCompensation":function(e){""===e&&(e=null),this.updateProperties({isForCompensation:e})},"formData.triggerable":function(e,t){void 0!==t&&(null===e&&(e=""),this.updateProperties({"flowable:triggerable":e}))},"formData.class":function(e,t){void 0!==t&&(""===e&&(e=""),this.updateProperties({"flowable:class":e}))},"formData.autoStoreVariables":function(e,t){void 0!==t&&(""===e&&(e=""),this.updateProperties({"flowable:autoStoreVariables":e}))},"formData.exclude":function(e,t){void 0!==t&&(""===e&&(e=""),this.updateProperties({"flowable:exclude":e}))},"formData.ruleVariablesInput":function(e,t){void 0!==t&&(""===e&&(e=""),this.updateProperties({"flowable:ruleVariablesInput":e}))},"formData.rules":function(e,t){void 0!==t&&(""===e&&(e=""),this.updateProperties({"flowable:rules":e}))},"formData.resultVariable":function(e,t){void 0!==t&&(""===e&&(e=null),this.updateProperties({"flowable:resultVariable":e}))}},created:function(){var e=this,t=R(this.element);if(t=K(t),this.formData=t,console.log("this.formData",JSON.stringify(this.formData)),this.formData.userType&&this.formData.dataType&&"fixed"===this.formData.dataType&&"candidateGroups"!=this.formData.userType){var n=this.formData[this.formData.userType];n&&re({userIds:n}).then((function(t){e.checkedUserData=t.data.items||[]})),this.userMode="assignee"===this.formData.userType?"single":"multiple"}this.computedExecutionListenerLength(),this.computedTaskListenerLength(),this.computedHasMultiInstance()},methods:{handleRemoveUser:function(e){this.checkedUserData.splice(this.checkedUserData.findIndex((function(t){return t.userId===e.userId})),1)},onUserSelect:function(){this.userDialogVisible=!0},handleSelectUser:function(e){var t=this,n=this.checkedUserData.map((function(e){return e.userId})),a=JSON.parse(e);if(0!==a.length)if("assignee"!==this.formData.userType)a.forEach((function(e,a){n.includes(e.userId)||t.checkedUserData.push({userId:e.userId,userName:e.userName,realName:e.realName,phonenumber:e.phonenumber})}));else{var i=a[0];this.checkedUserData=[{userId:i.userId,userName:i.userName,realName:i.realName,phonenumber:i.phonenumber}]}},computedExecutionListenerLength:function(){var e,t;this.executionListenerLength=null!==(e=null===(t=this.element.businessObject.extensionElements)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.filter((function(e){return"flowable:ExecutionListener"===e.$type})).length)&&void 0!==e?e:0},computedTaskListenerLength:function(){var e,t;this.taskListenerLength=null!==(e=null===(t=this.element.businessObject.extensionElements)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.filter((function(e){return"flowable:TaskListener"===e.$type})).length)&&void 0!==e?e:0},computedHasMultiInstance:function(){this.element.businessObject.loopCharacteristics?this.hasMultiInstance=!0:this.hasMultiInstance=!1},finishExecutionListener:function(){"executionListenerDialog"===this.dialogName&&this.computedExecutionListenerLength(),this.dialogName=""},finishTaskListener:function(){"taskListenerDialog"===this.dialogName&&this.computedTaskListenerLength(),this.dialogName=""},finishMultiInstance:function(){"multiInstanceDialog"===this.dialogName&&this.computedHasMultiInstance(),this.dialogName=""}}},de=ue,me=Object(E["a"])(de,p,f,!1,null,null,null),pe=me.exports,fe=function(){var e=this,t=e._self._c;return t("div",[t("x-form",{ref:"xForm",attrs:{config:e.formConfig},scopedSlots:e._u([{key:"executionListener",fn:function(){return[t("el-badge",{attrs:{value:e.executionListenerLength}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogName="executionListenerDialog"}}},[e._v("编辑")])],1)]},proxy:!0}]),model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}}),"executionListenerDialog"===e.dialogName?t("executionListenerDialog",{attrs:{element:e.element,modeler:e.modeler},on:{close:e.finishExecutionListener}}):e._e()],1)},he=[],ge={components:{executionListenerDialog:A},data:function(){return{executionListenerLength:0,dialogName:null}},methods:{computedExecutionListenerLength:function(){var e,t;this.executionListenerLength=null!==(e=null===(t=this.element.businessObject.extensionElements)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.length)&&void 0!==e?e:0},finishExecutionListener:function(){"executionListenerDialog"===this.dialogName&&this.computedExecutionListenerLength(),this.dialogName=""}}},be={mixins:[v,ge],data:function(){return{formData:{}}},computed:{formConfig:function(){var e=this;return{inline:!1,item:[{xType:"input",name:"id",label:"节点 id",rules:[{required:!0,message:"Id 不能为空"}]},{xType:"input",name:"name",label:"节点名称"},{xType:"input",name:"documentation",label:"节点描述"},{xType:"slot",name:"executionListener",label:"执行监听器"},{xType:"input",name:"initiator",label:"发起人",show:!!e.showConfig.initiator},{xType:"input",name:"formKey",label:"表单标识key",show:!!e.showConfig.formKey}]}}},watch:{"formData.initiator":function(e){""===e&&(e=null),this.updateProperties({"flowable:initiator":e})},"formData.formKey":function(e){""===e&&(e=null),this.updateProperties({"flowable:formKey":e})}},created:function(){this.formData=R(this.element)}},ye=be,ve=Object(E["a"])(ye,fe,he,!1,null,null,null),we=ve.exports,xe=function(){var e=this,t=e._self._c;return t("div",[t("x-form",{ref:"xForm",attrs:{config:e.formConfig},scopedSlots:e._u([{key:"executionListener",fn:function(){return[t("el-badge",{attrs:{value:e.executionListenerLength}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogName="executionListenerDialog"}}},[e._v("编辑")])],1)]},proxy:!0},{key:"signal",fn:function(){return[t("el-badge",{attrs:{value:e.signalLength}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogName="signalDialog"}}},[e._v("编辑")])],1)]},proxy:!0},{key:"processCategory",fn:function(){return[t("treeselect",{attrs:{options:e.categorys,normalizer:e.normalizer,"show-count":!0,placeholder:"选择所属分类"},model:{value:e.formData.processCategory,callback:function(t){e.$set(e.formData,"processCategory",t)},expression:"formData.processCategory"}})]},proxy:!0}]),model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}}),"executionListenerDialog"===e.dialogName?t("executionListenerDialog",{attrs:{element:e.element,modeler:e.modeler},on:{close:e.finishExecutionListener}}):e._e(),"signalDialog"===e.dialogName?t("signalDialog",{attrs:{element:e.element,modeler:e.modeler},on:{close:e.finishExecutionListener}}):e._e()],1)},ke=[],Ce=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:"信号定义",visible:e.dialogVisible,width:"700px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t},closed:function(t){return e.$emit("close")}}},[t("x-form",{ref:"xForm",attrs:{config:e.formConfig},model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.closeDialog}},[e._v("确 定")])],1)],1)],1)},De=[],Se={mixins:[v],data:function(){return{dialogVisible:!0,formData:{signal:[]}}},computed:{formConfig:function(){return{inline:!1,item:[{xType:"tabs",tabs:[{label:"信号定义",name:"signal",column:[{label:"scope",name:"scope",width:180,rules:[{required:!0,message:"请选择",trigger:["blur","change"]}],xType:"select",dic:[{label:"全局",value:"start"},{label:"流程实例",value:"end"}]},{label:"id",name:"id",width:200,rules:[{required:!0,message:"请输入",trigger:["blur","change"]}],xType:"input"},{label:"名称",name:"name",xType:"input",rules:[{required:!0,message:"请输入",trigger:["blur","change"]}]}]}]}]}}},mounted:function(){},methods:{updateElement:function(){var e;if(null!==(e=this.formData.signal)&&void 0!==e&&e.length){var t=this.element.businessObject.get("extensionElements");t||(t=this.modeler.get("moddle").create("bpmn:signal"));for(var n=t.get("values").length,a=0;a<n;a++)t.get("values").pop();this.updateProperties({extensionElements:t})}else{var i,r=this.element.businessObject["extensionElements"];if(r)r.values=null===(i=r.values)||void 0===i?void 0:i.filter((function(e){return"flowable:ExecutionListener"!==e.$type}))}},closeDialog:function(){var e=this;this.$refs.xForm.validate().then((function(){e.updateElement(),e.dialogVisible=!1})).catch((function(e){return console.error(e)}))}}},Te=Se,Ee=(n("c970"),Object(E["a"])(Te,Ce,De,!1,null,null,null)),Le=Ee.exports,Ie=n("ca17"),_e=n.n(Ie),Oe=(n("542c"),{components:{signalDialog:Le,Treeselect:_e.a},mixins:[v,ge],data:function(){return{signalLength:0,formData:{}}},computed:{formConfig:function(){return{inline:!1,item:[{xType:"slot",name:"processCategory",label:"流程分类"},{xType:"input",name:"id",label:"流程标识key",rules:[{required:!0,message:"Id 不能为空"}]},{xType:"input",name:"name",label:"流程名称"},{xType:"input",name:"documentation",label:"节点描述"},{xType:"slot",name:"executionListener",label:"执行监听器"},{xType:"slot",name:"signal",label:"信号定义"}]}}},watch:{"formData.processCategory":function(e){""===e&&(e=null),this.updateProperties({"flowable:processCategory":e})}},created:function(){this.formData=R(this.element),console.log("form data:",this.formData)},methods:{normalizer:function(e){return e.children&&!e.children.length&&delete e.children,{id:e.id,label:e.categoryName,children:e.children}},computedSignalLength:function(){var e,t;this.signalLength=null!==(e=null===(t=this.element.businessObject.extensionElements)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.length)&&void 0!==e?e:0},finishSignal:function(){"signalDialog"===this.dialogName&&this.computedSignalLength(),this.dialogName=""}}}),Pe=Oe,Ae=Object(E["a"])(Pe,xe,ke,!1,null,null,null),Ne=Ae.exports,je=function(){var e=this,t=e._self._c;return t("div",[t("x-form",{ref:"xForm",attrs:{config:e.formConfig},scopedSlots:e._u([{key:"executionListener",fn:function(){return[t("el-badge",{attrs:{value:e.executionListenerLength}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogName="executionListenerDialog"}}},[e._v("编辑")])],1)]},proxy:!0}]),model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}}),"executionListenerDialog"===e.dialogName?t("executionListenerDialog",{attrs:{element:e.element,modeler:e.modeler},on:{close:e.finishExecutionListener}}):e._e()],1)},Me=[],ze={mixins:[v,ge],data:function(){return{formData:{}}},computed:{formConfig:function(){return{inline:!1,item:[{xType:"input",name:"id",label:"节点 id",rules:[{required:!0,message:"Id 不能为空"}]},{xType:"input",name:"name",label:"节点名称"},{xType:"input",name:"documentation",label:"节点描述"},{xType:"slot",name:"executionListener",label:"执行监听器"},{xType:"input",name:"conditionExpression",label:"跳转条件"},{xType:"input",name:"skipExpression",label:"跳过表达式"}]}}},watch:{"formData.conditionExpression":function(e){if(e){var t=this.modeler.get("moddle").create("bpmn:FormalExpression",{body:e});this.updateProperties({conditionExpression:t})}else this.updateProperties({conditionExpression:null})},"formData.skipExpression":function(e){e?this.updateProperties({"flowable:skipExpression":e}):delete this.element.businessObject.$attrs["flowable:skipExpression"]}},created:function(){var e=R(this.element);e=Q(e),this.formData=e}},Fe=ze,Ue=Object(E["a"])(Fe,je,Me,!1,null,null,null),Be=Ue.exports,$e=function(){var e=this,t=e._self._c;return t("div",[t("x-form",{ref:"xForm",attrs:{config:e.formConfig},scopedSlots:e._u([{key:"executionListener",fn:function(){return[t("el-badge",{attrs:{value:e.executionListenerLength}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogName="executionListenerDialog"}}},[e._v("编辑")])],1)]},proxy:!0}]),model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}}),"executionListenerDialog"===e.dialogName?t("executionListenerDialog",{attrs:{element:e.element,modeler:e.modeler},on:{close:e.finishExecutionListener}}):e._e()],1)},qe=[],Re={mixins:[v,ge],data:function(){return{formData:{}}},computed:{formConfig:function(){return{inline:!1,item:[{xType:"input",name:"id",label:"节点 id",rules:[{required:!0,message:"Id 不能为空"}]},{xType:"input",name:"name",label:"节点名称"},{xType:"input",name:"documentation",label:"节点描述"},{xType:"slot",name:"executionListener",label:"执行监听器"},{xType:"switch",name:"async",label:"异步",activeText:"是",inactiveText:"否"}]}}},watch:{"formData.async":function(e){""===e&&(e=null),this.updateProperties({"flowable:async":e})}},created:function(){this.formData=R(this.element)}},Ve=Re,Ge=Object(E["a"])(Ve,$e,qe,!1,null,null,null),Qe=Ge.exports,Ke={name:"PropertyPanel",components:{processPanel:Ne,taskPanel:pe,startEndPanel:we,sequenceFlowPanel:Be,gatewayPanel:Qe},props:{users:{type:Array,required:!0},groups:{type:Array,required:!0},categorys:{type:Array,required:!0},modeler:{type:Object,required:!0}},data:function(){return{element:null,form:{id:"",name:"",color:null},roles:[{value:"manager",label:"经理"},{value:"personnel",label:"人事"},{value:"charge",label:"主管"}]}},computed:{getComponent:function(){var e,t=null===(e=this.element)||void 0===e?void 0:e.type;return["bpmn:IntermediateThrowEvent","bpmn:StartEvent","bpmn:EndEvent"].includes(t)?"startEndPanel":["bpmn:UserTask","bpmn:Task","bpmn:SendTask","bpmn:ReceiveTask","bpmn:ManualTask","bpmn:BusinessRuleTask","bpmn:ServiceTask","bpmn:ScriptTask","bpmn:CallActivity","bpmn:SubProcess"].includes(t)?"taskPanel":"bpmn:SequenceFlow"===t?"sequenceFlowPanel":["bpmn:InclusiveGateway","bpmn:ExclusiveGateway","bpmn:ParallelGateway","bpmn:EventBasedGateway"].includes(t)?"gatewayPanel":"bpmn:Process"===t?"processPanel":null},nodeName:function(){if(this.element){var e=this.element.businessObject,t=null!==e&&void 0!==e&&e.eventDefinitions?e.eventDefinitions[0].$type:e.$type;return l[t]||t}return""}},mounted:function(){this.handleModeler()},methods:{handleModeler:function(){var e=this;this.modeler.on("root.added",(function(t){"bpmn:Process"===t.element.type&&(e.element=null,e.$nextTick().then((function(){e.element=t.element})))})),this.modeler.on("element.click",(function(t){var n=t.element;console.log(n),"bpmn:Process"===n.type&&(e.element=n)})),this.modeler.on("selection.changed",(function(t){e.element=null;var n=t.newSelection[0];n&&e.$nextTick().then((function(){e.element=n}))}))},dataType:function(e){this.$emit("dataType",e)}}},Je=Ke,Xe=(n("22de"),Object(E["a"])(Je,d,m,!1,null,null,null)),He=Xe.exports,Ye=n("d4ec"),We=n("bee2"),Ze=function(){function e(){Object(Ye["a"])(this,e),this.controls=[],this.init()}return Object(We["a"])(e,[{key:"init",value:function(){this.controls=[{action:"create.start-event",title:"开始"},{action:"create.intermediate-event",title:"中间"},{action:"create.end-event",title:"结束"},{action:"create.exclusive-gateway",title:"网关"},{action:"create.task",title:"任务"},{action:"create.user-task",title:"用户任务"},{action:"create.user-sign-task",title:"会签任务"},{action:"create.subprocess-expanded",title:"子流程"},{action:"create.data-object",title:"数据对象"},{action:"create.data-store",title:"数据存储"},{action:"create.participant-expanded",title:"扩展流程"},{action:"create.group",title:"分组"}]}},{key:"getControl",value:function(e){var t=this.controls.filter((function(t){return t.action===e}));return t[0]||{}}}]),e}();n("99af"),n("fb6a"),n("25f0");function et(){return Math.random().toString(36).slice(-8)}var tt=function(){return'<?xml version="1.0" encoding="UTF-8"?>\n    <definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:bioc="http://bpmn.io/schema/bpmn/biocolor/1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:flowable="http://flowable.org/bpmn" targetNamespace="http://www.flowable.org/processdef">\n      <process id="process_'.concat(et(),'" name="name_').concat(et(),'">\n        <startEvent id="startNode1" name="开始" />\n      </process>\n      <bpmndi:BPMNDiagram id="BPMNDiagram_flow">\n        <bpmndi:BPMNPlane id="BPMNPlane_flow" bpmnElement="T-2d89e7a3-ba79-4abd-9f64-ea59621c258c">\n          <bpmndi:BPMNShape id="BPMNShape_startNode1" bpmnElement="startNode1" bioc:stroke="">\n            <omgdc:Bounds x="240" y="200" width="30" height="30" />\n            <bpmndi:BPMNLabel>\n              <omgdc:Bounds x="242" y="237" width="23" height="14" />\n            </bpmndi:BPMNLabel>\n          </bpmndi:BPMNShape>\n        </bpmndi:BPMNPlane>\n      </bpmndi:BPMNDiagram>\n    </definitions>\n    ')},nt=n("2730"),at={name:"WorkflowBpmnModeler",components:{panel:He},props:{xml:{type:String,default:""},users:{type:Array,default:function(){return[]}},groups:{type:Array,default:function(){return[]}},categorys:{type:Array,default:function(){return[]}},isView:{type:Boolean,default:!1},taskList:{type:Array,default:function(){return[]}}},data:function(){return{modeler:null,zoom:1}},watch:{xml:function(e){e&&this.createNewDiagram(e)}},mounted:function(){this.modeler=new u["a"]({container:this.$refs.canvas,additionalModules:[{zoomScroll:["value",""],translate:["value",c]}],moddleExtensions:{flowable:nt}}),this.xml?this.createNewDiagram(this.xml):this.newDiagram()},methods:{hide:function(){this.$emit("close")},newDiagram:function(){this.createNewDiagram(tt())},fitViewport:function(){this.zoom=this.modeler.get("canvas").zoom("fit-viewport");var e=document.querySelector(".flow-containers .viewport").getBBox(),t=this.modeler.get("canvas").viewbox(),n={x:e.x+e.width/2-65,y:e.y+e.height/2};this.modeler.get("canvas").viewbox({x:n.x-t.width/2,y:n.y-t.height/2,width:t.width,height:t.height}),this.zoom=e.width/t.width*1.8},zoomViewport:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.zoom=this.modeler.get("canvas").zoom(),this.zoom+=e?.1:-.1,this.modeler.get("canvas").zoom(this.zoom)},createNewDiagram:function(e){var t=this;return Object(o["a"])(Object(r["a"])().mark((function n(){return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e=e.replace(/<!\[CDATA\[(.+?)]]>/g,(function(e,t){return t.replace(/</g,"&lt;")})),n.prev=1,n.next=4,t.modeler.importXML(e);case 4:t.adjustPalette(),t.fitViewport(),void 0!==t.taskList&&t.taskList.length>0&&t.fillColor(),n.next=12;break;case 9:n.prev=9,n.t0=n["catch"](1),console.error(n.t0.message,n.t0.warnings);case 12:case"end":return n.stop()}}),n,null,[[1,9]])})))()},adjustPalette:function(){try{var e=this.$refs.canvas,t=e.children[0].children[1].children[4],n={width:"130px",padding:"5px",background:"white",left:"20px",borderRadius:0};for(var a in n)t.style[a]=n[a];var i=t.children[0],r=i.children;for(var o in r[0].style["display"]="none",r){var s=r[o];for(var l in s.children){var c=s.children[l],u={display:"flex",justifyContent:"flex-start",alignItems:"center",width:"100%",padding:"5px"};if(c.className&&c.dataset&&-1!==c.className.indexOf("entry")){var d=(new Ze).getControl(c.dataset.action);for(var m in c.innerHTML="<div style='font-size: 14px;font-weight:500;margin-left:15px;'>".concat(d["title"],"</div>"),u)c.style[m]=u[m]}}}}catch(p){console.log(p)}},fillColor:function(){var e=this,t=this.modeler.get("canvas");this.modeler._definitions.rootElements[0].flowElements.forEach((function(n){var a,i=e.taskList.find((function(e){return e.key===n.id})),r=e.taskList.find((function(e){return!e.completed})),o=e.taskList[e.taskList.length-1];if("bpmn:UserTask"===n.$type)i&&(t.addMarker(n.id,i.completed?"highlight":"highlight-todo"),null===(a=n.outgoing)||void 0===a||a.forEach((function(n){var a=e.taskList.find((function(e){return e.key===n.targetRef.id}));a&&(r&&i.key===r.key&&!r.completed?(t.addMarker(n.id,r.completed?"highlight":"highlight-todo"),t.addMarker(n.targetRef.id,r.completed?"highlight":"highlight-todo")):(t.addMarker(n.id,a.completed?"highlight":"highlight-todo"),t.addMarker(n.targetRef.id,a.completed?"highlight":"highlight-todo")))})));else if("bpmn:ExclusiveGateway"===n.$type){var s;if(i)t.addMarker(n.id,i.completed?"highlight":"highlight-todo"),null===(s=n.outgoing)||void 0===s||s.forEach((function(n){var a=e.taskList.find((function(e){return e.key===n.targetRef.id}));a&&(t.addMarker(n.id,a.completed?"highlight":"highlight-todo"),t.addMarker(n.targetRef.id,a.completed?"highlight":"highlight-todo"))}))}else if("bpmn:ParallelGateway"===n.$type){var l;if(i)t.addMarker(n.id,i.completed?"highlight":"highlight-todo"),null===(l=n.outgoing)||void 0===l||l.forEach((function(n){var a=e.taskList.find((function(e){return e.key===n.targetRef.id}));a&&(t.addMarker(n.id,a.completed?"highlight":"highlight-todo"),t.addMarker(n.targetRef.id,a.completed?"highlight":"highlight-todo"))}))}else if("bpmn:StartEvent"===n.$type)n.outgoing.forEach((function(a){var i=e.taskList.find((function(e){return e.key===a.targetRef.id}));if(i)return t.addMarker(a.id,"highlight"),void t.addMarker(n.id,"highlight")}));else if("bpmn:EndEvent"===n.$type&&o.key===n.id&&o.completed)return void t.addMarker(n.id,"highlight")}))},getProcess:function(){var e=this.getProcessElement();return{id:e.id,name:e.name,category:e.$attrs["flowable:processCategory"]}},getProcessElement:function(){for(var e=this.modeler.getDefinitions().rootElements,t=0;t<e.length;t++)if("bpmn:Process"===e[t].$type)return e[t]},saveXML:function(){var e=arguments,t=this;return Object(o["a"])(Object(r["a"])().mark((function n(){var a,i,o;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]&&e[0],n.prev=1,n.next=4,t.modeler.saveXML({format:!0});case 4:return i=n.sent,o=i.xml,a&&t.downloadFile("".concat(t.getProcessElement().name,".bpmn20.xml"),o,"application/xml"),n.abrupt("return",o);case 10:n.prev=10,n.t0=n["catch"](1),console.log(n.t0);case 13:case"end":return n.stop()}}),n,null,[[1,10]])})))()},showXML:function(){var e=this;return Object(o["a"])(Object(r["a"])().mark((function t(){var n,a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.modeler.saveXML({format:!0});case 3:n=t.sent,a=n.xml,e.$emit("showXML",a),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},saveImg:function(){var e=arguments,t=this;return Object(o["a"])(Object(r["a"])().mark((function n(){var a,i,o;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.length>0&&void 0!==e[0]?e[0]:"svg",a=e.length>1&&void 0!==e[1]&&e[1],n.prev=2,n.next=5,t.modeler.saveSVG({format:!0});case 5:return i=n.sent,o=i.svg,a&&t.downloadFile(t.getProcessElement().name,o,"image/svg+xml"),n.abrupt("return",o);case 11:n.prev=11,n.t0=n["catch"](2),console.log(n.t0);case 14:case"end":return n.stop()}}),n,null,[[2,11]])})))()},save:function(){var e=this;return Object(o["a"])(Object(r["a"])().mark((function t(){var n,a,i,o;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.getProcess(),t.next=3,e.saveXML();case 3:return a=t.sent,t.next=6,e.saveImg();case 6:i=t.sent,o={process:n,xml:a,svg:i},e.$emit("save",o);case 9:case"end":return t.stop()}}),t)})))()},openBpmn:function(e){var t=this,n=new FileReader;return n.readAsText(e,"utf-8"),n.onload=function(){t.createNewDiagram(n.result)},!1},downloadFile:function(e,t,n){var a=document.createElement("a"),i=window.URL.createObjectURL(new Blob([t],{type:n}));a.href=i,a.download=e,a.click(),window.URL.revokeObjectURL(i)},dataType:function(e){this.$emit("dataType",e)}}},it=at,rt=(n("8280"),Object(E["a"])(it,a,i,!1,null,null,null)),ot=rt.exports;ot.install=function(e){return e.component(ot.name,ot)};t["a"]=ot},b0a8:function(e,t,n){},b212:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("bpmn-modeler",{ref:"refNode",attrs:{xml:e.xml,users:e.users,groups:e.groups,categorys:e.categorys,"is-view":!1},on:{save:e.save,showXML:e.showXML,dataType:e.dataType,close:e.close}}),e.xmlOpen?t("el-dialog",{attrs:{title:e.xmlTitle,visible:e.xmlOpen,width:"60%","append-to-body":""},on:{"update:visible":function(t){e.xmlOpen=t}}},[t("div",{directives:[{name:"highlight",rawName:"v-highlight"}]},[t("pre",[e._v("         "),t("code",{staticClass:"xml"},[e._v("\n            "+e._s(e.xmlContent)+"\n         ")]),e._v("\n      ")])])]):e._e()],1)},i=[],r=(n("b0c0"),n("d3b7"),n("159b"),n("db18")),o=n("ae3a"),s=n("347e"),l=n.n(s),c=n("1487"),u=n.n(c),d=(n("9f21"),n("fef2")),m=n("ca17"),p=n.n(m),f=(n("542c"),{name:"Model",props:{forward:Function,enterParams:{type:Object,default:function(){return{}}}},components:{Treeselect:p.a,bpmnModeler:o["a"],vkbeautify:l.a},directives:{highlight:function(e){var t=e.querySelectorAll("pre code");t.forEach((function(e){u.a.highlightBlock(e)}))}},data:function(){return{xml:"",modeler:"",xmlOpen:!1,xmlTitle:"",xmlContent:"",users:[],groups:[],categorys:[]}},created:function(){if("edit"==this.enterParams.type){var e=this.enterParams.deployId;console.log("deployid:",e),this.getModelDetail(e)}this.getTenantCategoryList(),this.getDataList()},methods:{close:function(){this.forward("List")},getTenantCategoryList:function(){var e=this;Object(d["f"])().then((function(t){e.categorys=t.data.items}))},getModelDetail:function(e){var t=this;Object(r["e"])({deployId:e}).then((function(e){t.xml=e.data,t.modeler=e.data}))},save:function(e){var t=this,n={name:e.process.name,categoryId:e.process.category,xml:e.xml};Object(r["g"])(n).then((function(e){t.forward("List")}))},getDataList:function(){var e=this;Object(r["f"])({status:0}).then((function(t){t.data.items.forEach((function(e){e.roleId=e.id})),e.groups=t.data.items}))},showXML:function(e){this.xmlTitle="xml查看",this.xmlContent=l.a.xml(e),this.xmlOpen=!0},dataType:function(e){this.users=[],this.groups=[],e&&("dynamic"===e.dataType?"assignee"===e.userType?this.users=[{realName:"${INITIATOR}",userId:"${INITIATOR}"},{realName:"#{approval}",userId:"#{approval}"}]:"candidateUsers"===e.userType?this.users=[{realName:"#{approval}",userId:"#{approval}"}]:this.groups=[{roleName:"#{approval}",roleId:"#{approval}"}]:this.getDataList())}}}),h=f,g=n("2877"),b=Object(g["a"])(h,a,i,!1,null,null,null);t["default"]=b.exports},b8b8:function(e,t,n){},c0fc:function(e,t,n){"use strict";n("b8b8")},c1bc1:function(e,t,n){},c970:function(e,t,n){"use strict";n("449f")},c9a7:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e._self._c;return t(e.curComponent,{tag:"component",attrs:{enterParams:e.enterParams,forward:e.forward}})},i=[],r=n("114a"),o=n("b212"),s={name:"WorkflowConfig",components:{List:r["default"],Form:o["default"]},data:function(){return{curComponent:"List",enterParams:{}}},methods:{forward:function(e,t){this.curComponent=e,this.enterParams=t||{}}}},l=s,c=n("2877"),u=Object(c["a"])(l,a,i,!1,null,null,null);t["default"]=u.exports},d2bc:function(e,t,n){},d314:function(e,t,n){"use strict";n("f815")},dac7:function(e,t,n){},db18:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"i",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return m}));var a=n("b775");function i(e){return Object(a["a"])({url:"/adm-service/workflow/definition/list",method:"post",data:e})}function r(e){return Object(a["a"])({url:"/workflow/flowDefinition/updateState",method:"put",params:e})}function o(e){return Object(a["a"])({url:"/adm-service/system/webuser/role/all",method:"post",data:e})}function s(e){return Object(a["a"])({url:"/adm-service/workflow/definition/readXml",method:"post",data:e})}function l(e){return Object(a["a"])({url:"/adm-service/workflow/definition/save",method:"post",data:e})}function c(e){return Object(a["a"])({url:"/system/deployment",method:"post",data:e})}function u(e){return Object(a["a"])({url:"/system/deployment",method:"put",data:e})}function d(e){return Object(a["a"])({url:"/adm-service/workflow/definition/delete",method:"post",data:e})}function m(e){return Object(a["a"])({url:"/workflow/deployment/export",method:"get",params:e})}},dd53:function(e,t,n){"use strict";n("b0a8")},ef3c:function(e,t,n){"use strict";n.r(t);n("ac1f"),n("5319");var a,i,r={created:function(){var e=this.$route,t=e.params,n=e.query,a=t.path;this.$router.replace({path:"/"+a,query:n})},render:function(e){return e()}},o=r,s=n("2877"),l=Object(s["a"])(o,a,i,!1,null,null,null);t["default"]=l.exports},f815:function(e,t,n){},fef2:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"h",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return d}));var a=n("b775");function i(e){return Object(a["a"])({url:"/adm-service/workflow/category/trees",method:"post",data:e||{}})}function r(e){return Object(a["a"])({url:"/adm-service/workflow/category/get",method:"get",params:e})}function o(e){return Object(a["a"])({url:"/adm-service/workflow/category/del",method:"post",data:e})}function s(e){return Object(a["a"])({url:"/adm-service/workflow/category/add",method:"post",data:e})}function l(e){return Object(a["a"])({url:"/adm-service/workflow/category/edit",method:"post",data:e})}function c(e){return Object(a["a"])({url:"/adm-service/workflow/category/procTrees",method:"post",data:e||{}})}function u(e){return Object(a["a"])({url:"/adm-service/workflow/proc/config/edit",method:"post",data:e||{}})}function d(e){return Object(a["a"])({url:"/adm-service/workflow/proc/config/get",method:"get",params:e})}}}]);